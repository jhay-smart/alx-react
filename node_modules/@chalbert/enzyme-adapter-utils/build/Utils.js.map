{"version":3,"file":"Utils.js","names":["mapNativeEventNames","event","nativeToReactEventMap","compositionend","compositionstart","compositionupdate","keydown","keyup","keypress","contextmenu","dblclick","doubleclick","dragend","dragenter","dragexist","dragleave","dragover","dragstart","mousedown","mousemove","mouseout","mouseover","mouseup","touchcancel","touchend","touchmove","touchstart","canplay","canplaythrough","durationchange","loadeddata","loadedmetadata","loadstart","ratechange","timeupdate","volumechange","beforeinput","mouseenter","mouseleave","transitionend","animationstart","animationiteration","animationend","pointerdown","pointermove","pointerup","pointercancel","gotpointercapture","lostpointercapture","pointerenter","pointerleave","pointerover","pointerout","auxclick","propFromEvent","nativeEvent","toUpperCase","slice","withSetStateAllowed","fn","cleanup","global","document","result","undefined","assertDomAvailable","feature","createElement","Error","displayNameOfNode","node","type","displayName","functionName","name","nodeTypeFromType","prototype","isReactComponent","getIteratorFn","obj","iteratorFn","Symbol","iterator","isIterable","isArrayLike","Array","isArray","flatten","arrs","reduce","flatArrs","item","concat","call","step","next","done","value","flatItem","ensureKeyOrUndefined","key","elementToTree","el","recurse","arguments","length","props","ref","children","rendered","map","x","nodeType","dangerouslySetInnerHTML","error","instance","mapFind","arraylike","mapper","finder","found","isFound","find","findElement","predicate","propsWithKeysAndRef","getComponentStack","hierarchy","getNodeType","getDisplayName","tuples","filter","RootFinder","i","arr","closestComponent","join","simulateError","catchingInstance","rootNode","catchingType","componentDidCatch","getDerivedStateFromError","stateUpdate","flushSync","setState","componentStack","getMaskedContext","contextTypes","unmaskedContext","fromEntries","Object","keys","getNodeFromRootFinder","isCustomComponent","tree","options","wrappingComponent","rootFinder","wrapWithWrappingComponent","wrappingComponentProps","getWrappingComponentMountRenderer","toTree","getMountWrapperInstance","getNode","render","context","callback","setWrappingComponentProps","fakeDynamicImport","moduleToImport","Promise","resolve","compareNodeTypeOf","matchingTypeOf","$$typeof","spyMethod","methodName","getStub","lastReturnValue","originalMethod","hasOwn","has","descriptor","getOwnPropertyDescriptor","defineProperty","configurable","enumerable","spied","args","apply","restore","getLastReturnValue","spyProperty","propertyName","handlers","originalValue","wasAssigned","holder","getV","get","set","newValue","handlerNewValue","v","getPublicRootInstance","container","containerFiber","_internalRoot","current","child","tag","HostComponent","getPublicInstance","stateNode"],"sources":["../src/Utils.js"],"sourcesContent":["import functionName from 'function.prototype.name';\nimport fromEntries from 'object.fromentries';\nimport has from 'has';\nimport createMountWrapper from './createMountWrapper';\nimport createRenderWrapper from './createRenderWrapper';\nimport wrap from './wrapWithSimpleWrapper';\nimport RootFinder from './RootFinder';\nimport { HostComponent } from './tagCodes';\nimport { flushSync } from 'react-dom';\n\nexport { createMountWrapper, createRenderWrapper, wrap, RootFinder };\n\nexport function mapNativeEventNames(event) {\n  const nativeToReactEventMap = {\n    compositionend: 'compositionEnd',\n    compositionstart: 'compositionStart',\n    compositionupdate: 'compositionUpdate',\n    keydown: 'keyDown',\n    keyup: 'keyUp',\n    keypress: 'keyPress',\n    contextmenu: 'contextMenu',\n    dblclick: 'doubleClick',\n    doubleclick: 'doubleClick', // kept for legacy. TODO: remove with next major.\n    dragend: 'dragEnd',\n    dragenter: 'dragEnter',\n    dragexist: 'dragExit',\n    dragleave: 'dragLeave',\n    dragover: 'dragOver',\n    dragstart: 'dragStart',\n    mousedown: 'mouseDown',\n    mousemove: 'mouseMove',\n    mouseout: 'mouseOut',\n    mouseover: 'mouseOver',\n    mouseup: 'mouseUp',\n    touchcancel: 'touchCancel',\n    touchend: 'touchEnd',\n    touchmove: 'touchMove',\n    touchstart: 'touchStart',\n    canplay: 'canPlay',\n    canplaythrough: 'canPlayThrough',\n    durationchange: 'durationChange',\n    loadeddata: 'loadedData',\n    loadedmetadata: 'loadedMetadata',\n    loadstart: 'loadStart',\n    ratechange: 'rateChange',\n    timeupdate: 'timeUpdate',\n    volumechange: 'volumeChange',\n    beforeinput: 'beforeInput',\n    mouseenter: 'mouseEnter',\n    mouseleave: 'mouseLeave',\n    transitionend: 'transitionEnd',\n    animationstart: 'animationStart',\n    animationiteration: 'animationIteration',\n    animationend: 'animationEnd',\n    pointerdown: 'pointerDown',\n    pointermove: 'pointerMove',\n    pointerup: 'pointerUp',\n    pointercancel: 'pointerCancel',\n    gotpointercapture: 'gotPointerCapture',\n    lostpointercapture: 'lostPointerCapture',\n    pointerenter: 'pointerEnter',\n    pointerleave: 'pointerLeave',\n    pointerover: 'pointerOver',\n    pointerout: 'pointerOut',\n    auxclick: 'auxClick',\n  };\n\n  return nativeToReactEventMap[event] || event;\n}\n\n// 'click' => 'onClick'\n// 'mouseEnter' => 'onMouseEnter'\nexport function propFromEvent(event) {\n  const nativeEvent = mapNativeEventNames(event);\n  return `on${nativeEvent[0].toUpperCase()}${nativeEvent.slice(1)}`;\n}\n\nexport function withSetStateAllowed(fn) {\n  // NOTE(lmr):\n  // this is currently here to circumvent a React bug where `setState()` is\n  // not allowed without global being defined.\n  let cleanup = false;\n  if (typeof global.document === 'undefined') {\n    cleanup = true;\n    global.document = {};\n  }\n  const result = fn();\n  if (cleanup) {\n    // This works around a bug in node/jest in that developers aren't able to\n    // delete things from global when running in a node vm.\n    global.document = undefined;\n    delete global.document;\n  }\n  return result;\n}\n\nexport function assertDomAvailable(feature) {\n  if (!global || !global.document || !global.document.createElement) {\n    throw new Error(`Enzyme's ${feature} expects a DOM environment to be loaded, but found none`);\n  }\n}\n\nexport function displayNameOfNode(node) {\n  if (!node) return null;\n\n  const { type } = node;\n\n  if (!type) return null;\n\n  return type.displayName || (typeof type === 'function' ? functionName(type) : type.name || type);\n}\n\nexport function nodeTypeFromType(type) {\n  if (typeof type === 'string') {\n    return 'host';\n  }\n  if (type && type.prototype && type.prototype.isReactComponent) {\n    return 'class';\n  }\n  return 'function';\n}\n\nfunction getIteratorFn(obj) {\n  const iteratorFn =\n    obj &&\n    ((typeof Symbol === 'function' &&\n      typeof Symbol.iterator === 'symbol' &&\n      obj[Symbol.iterator]) ||\n      obj['@@iterator']);\n\n  if (typeof iteratorFn === 'function') {\n    return iteratorFn;\n  }\n\n  return undefined;\n}\n\nfunction isIterable(obj) {\n  return !!getIteratorFn(obj);\n}\n\nexport function isArrayLike(obj) {\n  return Array.isArray(obj) || (typeof obj !== 'string' && isIterable(obj));\n}\n\nexport function flatten(arrs) {\n  // optimize for the most common case\n  if (Array.isArray(arrs)) {\n    return arrs.reduce(\n      (flatArrs, item) => flatArrs.concat(isArrayLike(item) ? flatten(item) : item),\n      [],\n    );\n  }\n\n  // fallback for arbitrary iterable children\n  let flatArrs = [];\n\n  const iteratorFn = getIteratorFn(arrs);\n  const iterator = iteratorFn.call(arrs);\n\n  let step = iterator.next();\n\n  while (!step.done) {\n    const item = step.value;\n    let flatItem;\n\n    if (isArrayLike(item)) {\n      flatItem = flatten(item);\n    } else {\n      flatItem = item;\n    }\n\n    flatArrs = flatArrs.concat(flatItem);\n\n    step = iterator.next();\n  }\n\n  return flatArrs;\n}\n\nexport function ensureKeyOrUndefined(key) {\n  return key || (key === '' ? '' : undefined);\n}\n\nexport function elementToTree(el, recurse = elementToTree) {\n  if (typeof recurse !== 'function' && arguments.length === 3) {\n    // special case for backwards compat for `.map(elementToTree)`\n    recurse = elementToTree;\n  }\n  if (el === null || typeof el !== 'object' || !('type' in el)) {\n    return el;\n  }\n  const { type, props, key, ref } = el;\n  const { children } = props;\n  let rendered = null;\n  if (isArrayLike(children)) {\n    rendered = flatten(children).map((x) => recurse(x));\n  } else if (typeof children !== 'undefined') {\n    rendered = recurse(children);\n  }\n\n  const nodeType = nodeTypeFromType(type);\n\n  if (nodeType === 'host' && props.dangerouslySetInnerHTML) {\n    if (props.children != null) {\n      const error = new Error('Can only set one of `children` or `props.dangerouslySetInnerHTML`.');\n      error.name = 'Invariant Violation';\n      throw error;\n    }\n  }\n\n  return {\n    nodeType,\n    type,\n    props,\n    key: ensureKeyOrUndefined(key),\n    ref,\n    instance: null,\n    rendered,\n  };\n}\n\nfunction mapFind(arraylike, mapper, finder) {\n  let found;\n  const isFound = Array.prototype.find.call(arraylike, (item) => {\n    found = mapper(item);\n    return finder(found);\n  });\n  return isFound ? found : undefined;\n}\n\nexport function findElement(el, predicate) {\n  if (el === null || typeof el !== 'object' || !('type' in el)) {\n    return undefined;\n  }\n  if (predicate(el)) {\n    return el;\n  }\n  const { rendered } = el;\n  if (isArrayLike(rendered)) {\n    return mapFind(\n      rendered,\n      (x) => findElement(x, predicate),\n      (x) => typeof x !== 'undefined',\n    );\n  }\n  return findElement(rendered, predicate);\n}\n\nexport function propsWithKeysAndRef(node) {\n  if (node.ref !== null || node.key !== null) {\n    return {\n      ...node.props,\n      key: node.key,\n      ref: node.ref,\n    };\n  }\n  return node.props;\n}\n\nexport function getComponentStack(\n  hierarchy,\n  getNodeType = nodeTypeFromType,\n  getDisplayName = displayNameOfNode,\n) {\n  const tuples = hierarchy\n    .filter((node) => node.type !== RootFinder)\n    .map((x) => [getNodeType(x.type), getDisplayName(x)])\n    .concat([['class', 'WrapperComponent']]);\n\n  return tuples\n    .map(([, name], i, arr) => {\n      const [, closestComponent] = arr.slice(i + 1).find(([nodeType]) => nodeType !== 'host') || [];\n      return `\\n    in ${name}${closestComponent ? ` (created by ${closestComponent})` : ''}`;\n    })\n    .join('');\n}\n\nexport function simulateError(\n  error,\n  catchingInstance,\n  rootNode, // TODO: remove `rootNode` next semver-major\n  hierarchy,\n  getNodeType = nodeTypeFromType,\n  getDisplayName = displayNameOfNode,\n  catchingType = {},\n) {\n  const instance = catchingInstance || {};\n\n  const { componentDidCatch } = instance;\n\n  const { getDerivedStateFromError } = catchingType;\n\n  if (!componentDidCatch && !getDerivedStateFromError) {\n    throw error;\n  }\n\n  if (getDerivedStateFromError) {\n    const stateUpdate = getDerivedStateFromError.call(catchingType, error);\n    flushSync(() => {\n      instance.setState(stateUpdate);\n    })\n  }\n\n  if (componentDidCatch) {\n    const componentStack = getComponentStack(hierarchy, getNodeType, getDisplayName);\n    componentDidCatch.call(instance, error, { componentStack });\n  }\n}\n\nexport function getMaskedContext(contextTypes, unmaskedContext) {\n  if (!contextTypes || !unmaskedContext) {\n    return {};\n  }\n  return fromEntries(Object.keys(contextTypes).map((key) => [key, unmaskedContext[key]]));\n}\n\nexport function getNodeFromRootFinder(isCustomComponent, tree, options) {\n  if (!isCustomComponent(options.wrappingComponent)) {\n    return tree.rendered;\n  }\n  const rootFinder = findElement(tree, (node) => node.type === RootFinder);\n  if (!rootFinder) {\n    throw new Error('`wrappingComponent` must render its children!');\n  }\n  return rootFinder.rendered;\n}\n\nexport function wrapWithWrappingComponent(createElement, node, options) {\n  const { wrappingComponent, wrappingComponentProps } = options;\n  if (!wrappingComponent) {\n    return node;\n  }\n  return createElement(\n    wrappingComponent,\n    wrappingComponentProps,\n    createElement(RootFinder, null, node),\n  );\n}\n\nexport function getWrappingComponentMountRenderer({ toTree, getMountWrapperInstance }) {\n  return {\n    getNode() {\n      const instance = getMountWrapperInstance();\n      return instance ? toTree(instance).rendered : null;\n    },\n    render(el, context, callback) {\n      const instance = getMountWrapperInstance();\n      if (!instance) {\n        throw new Error('The wrapping component may not be updated if the root is unmounted.');\n      }\n      return instance.setWrappingComponentProps(el.props, callback);\n    },\n  };\n}\n\nexport function fakeDynamicImport(moduleToImport) {\n  return Promise.resolve({ default: moduleToImport });\n}\n\nexport function compareNodeTypeOf(node, matchingTypeOf) {\n  if (!node) {\n    return false;\n  }\n  return node.$$typeof === matchingTypeOf;\n}\n\n// TODO: when enzyme v3.12.0 is required, delete this\nexport function spyMethod(instance, methodName, getStub = () => {}) {\n  let lastReturnValue;\n  const originalMethod = instance[methodName];\n  const hasOwn = has(instance, methodName);\n  let descriptor;\n  if (hasOwn) {\n    descriptor = Object.getOwnPropertyDescriptor(instance, methodName);\n  }\n  Object.defineProperty(instance, methodName, {\n    configurable: true,\n    enumerable: !descriptor || !!descriptor.enumerable,\n    value:\n      getStub(originalMethod) ||\n      function spied(...args) {\n        const result = originalMethod.apply(this, args);\n        lastReturnValue = result;\n        return result;\n      },\n  });\n  return {\n    restore() {\n      if (hasOwn) {\n        if (descriptor) {\n          Object.defineProperty(instance, methodName, descriptor);\n        } else {\n          instance[methodName] = originalMethod;\n        }\n      } else {\n        delete instance[methodName];\n      }\n    },\n    getLastReturnValue() {\n      return lastReturnValue;\n    },\n  };\n}\n\n// TODO: when enzyme v3.12.0 is required, delete this\nexport function spyProperty(instance, propertyName, handlers = {}) {\n  const originalValue = instance[propertyName];\n  const hasOwn = has(instance, propertyName);\n  let descriptor;\n  if (hasOwn) {\n    descriptor = Object.getOwnPropertyDescriptor(instance, propertyName);\n  }\n  let wasAssigned = false;\n  let holder = originalValue;\n  const getV = handlers.get\n    ? () => {\n        const value = descriptor && descriptor.get ? descriptor.get.call(instance) : holder;\n        return handlers.get.call(instance, value);\n      }\n    : () => holder;\n  const set = handlers.set\n    ? (newValue) => {\n        wasAssigned = true;\n        const handlerNewValue = handlers.set.call(instance, holder, newValue);\n        holder = handlerNewValue;\n        if (descriptor && descriptor.set) {\n          descriptor.set.call(instance, holder);\n        }\n      }\n    : (v) => {\n        wasAssigned = true;\n        holder = v;\n      };\n  Object.defineProperty(instance, propertyName, {\n    configurable: true,\n    enumerable: !descriptor || !!descriptor.enumerable,\n    get: getV,\n    set,\n  });\n\n  return {\n    restore() {\n      if (hasOwn) {\n        if (descriptor) {\n          Object.defineProperty(instance, propertyName, descriptor);\n        } else {\n          instance[propertyName] = holder;\n        }\n      } else {\n        delete instance[propertyName];\n      }\n    },\n    wasAssigned() {\n      return wasAssigned;\n    },\n  };\n}\n\nexport function getPublicRootInstance(container) {\n  var containerFiber = container._internalRoot.current;\n\n  if (!containerFiber.child) {\n    return null;\n  }\n\n  switch (containerFiber.child.tag) {\n    case HostComponent:\n      return getPublicInstance(containerFiber.child.stateNode);\n\n    default:\n      return containerFiber.child.stateNode;\n  }\n}\n\nfunction getPublicInstance(instance) {\n  return instance;\n}\n"],"mappings":"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"}