{"version":3,"file":"ReactEighteenAdapter.js","names":["nodeAndSiblingsArray","nodeWithSibling","array","node","push","sibling","flatten","arr","result","stack","i","length","n","pop","el","Array","isArray","nodeTypeFromType","type","Portal","utilNodeTypeFromType","isMemo","compareNodeTypeOf","Memo","isLazy","Lazy","unmemoType","checkIsSuspenseAndCloneElement","suspenseFallback","isSuspense","children","props","fallback","replaceLazyWithFallback","FakeSuspenseWrapper","React","createElement","elementToTree","isPortal","utilElementToTree","containerInfo","nodeType","key","ensureKeyOrUndefined","ref","instance","rendered","toTree","vnode","findCurrentFiberUsingSlowPath","tag","TAG_CODES","HostRoot","childrenToTree","child","HostPortal","stateNode","memoizedProps","IndeterminateComponent","IncompleteClassComponent","ClassComponent","FunctionComponent","MemoClass","elementType","MemoSFC","renderedNodes","map","HostComponent","HostText","DehydratedFragment","Fragment","Mode","ContextProvider","ContextConsumer","Profiler","MemoComponent","SimpleMemoComponent","ForwardRef","pendingProps","SuspenseListComponent","SuspenseComponent","Suspense","LazyComponent","ScopeComponent","OffscreenComponent","LegacyHiddenComponent","CacheComponent","TracingMarkerComponent","Error","nodeToHostNode","_node","mapper","item","findDOMNode","getEmptyStateValue","EmptyState","Component","testRenderer","ShallowRenderer","render","_instance","state","wrapAct","fn","returnVal","TestUtils","act","getProviderDefaultValue","Provider","_context","_defaultValue","_currentValue","makeFakeElement","$$typeof","Element","isStateful","prototype","isReactComponent","__reactAutoBindPairs","ReactEighteenAdapter","ReactWrapper","setProps","setState","args","apply","lifecycles","options","enableComponentDidUpdateOnSetState","legacyContextMode","componentDidUpdate","onSetState","getDerivedStateFromProps","hasShouldComponentUpdateBug","getSnapshotBeforeUpdate","skipsComponentDidUpdateOnNullish","getChildContext","calledByRenderer","getDerivedStateFromError","assertDomAvailable","has","TypeError","attachTo","hydrateIn","wrappingComponentProps","domNode","global","document","adapter","root","context","callback","wrapperProps","refProp","wrappedEl","ReactWrapperComponent","createMountWrapper","hydrateRoot","createRoot","flushSync","getPublicRootInstance","setChildProps","unmount","getNode","getNodeFromRootFinder","isCustomComponent","_reactInternals","simulateError","nodeHierarchy","rootNode","error","isErrorBoundary","elInstance","componentDidCatch","find","catchingInstance","catchingType","displayNameOfNode","simulateEvent","event","mock","mappedEvent","mapNativeEventNames","eventFn","Simulate","batchedUpdates","getWrappingComponentRenderer","getWrappingComponentMountRenderer","inst","getMountWrapperInstance","wrapInvoke","renderer","isDOM","cachedNode","lastComponent","wrappedComponent","sentinel","wrapPureComponent","compare","shouldComponentUpdate","nextProps","isPureReactComponent","memoized","prevProps","wrappedComponentFn","shouldUpdate","shallowEqual","defaultProps","Object","assign","displayName","wrapFunctionalComponent","renderElement","elConfig","rest","renderedEl","typeIsExisted","clonedEl","elementIsChanged","unmaskedContext","providerValues","Map","isContextProvider","set","value","MockProvider","withSetStateAllowed","isContextConsumer","getProviderFromConsumer","get","MockConsumer","getMaskedContext","contextTypes","InnerComp","isComponentStateful","spyMethod","originalMethod","_updateClassComponent","clonedProps","restore","emptyStateValue","defineProperty","configurable","enumerable","writable","output","getRenderOutput","concat","handler","propFromEvent","checkPropTypes","typeSpecs","values","location","hierarchy","getComponentStack","childContextTypes","ContextWrapper","createRenderWrapper","ReactDOMServer","renderToStaticMarkup","mode","EnzymeAdapter","MODES","MOUNT","createMountRenderer","SHALLOW","createShallowRenderer","STRING","createStringRenderer","element","wrap","propsWithKeysAndRef","matchingType","supportsArray","nodes","filter","Boolean","ConcurrentMode","NaN","StrictMode","$$typeofType","nodeName","name","isElement","object","isValidElementType","fragment","typeOfNode","fakeElement","isForwardRef","isValidElement","Consumer","RootFinder","wrapWithWrappingComponent","module","exports"],"sources":["../src/ReactEighteenAdapter.js"],"sourcesContent":["import React from 'react';\nimport { flushSync, findDOMNode } from 'react-dom';\nimport { createRoot, hydrateRoot } from 'react-dom/client';\nimport ReactDOMServer from 'react-dom/server';\nimport ShallowRenderer from 'react-test-renderer/shallow';\nimport TestUtils from 'react-dom/test-utils';\nimport checkPropTypes from 'prop-types/checkPropTypes';\nimport has from 'has';\nimport {\n  ConcurrentMode,\n  ContextConsumer,\n  ContextProvider,\n  Element,\n  ForwardRef,\n  Fragment,\n  isContextConsumer,\n  isContextProvider,\n  isElement,\n  isForwardRef,\n  isPortal,\n  isSuspense,\n  isValidElementType,\n  Lazy,\n  Memo,\n  Portal,\n  Profiler,\n  StrictMode,\n  Suspense,\n} from 'react-is';\nimport { EnzymeAdapter, ReactWrapper } from 'enzyme';\nimport { typeOfNode } from 'enzyme/build/Utils';\nimport shallowEqual from 'enzyme-shallow-equal';\nimport {\n  displayNameOfNode,\n  elementToTree as utilElementToTree,\n  nodeTypeFromType as utilNodeTypeFromType,\n  mapNativeEventNames,\n  propFromEvent,\n  assertDomAvailable,\n  withSetStateAllowed,\n  createRenderWrapper,\n  createMountWrapper,\n  propsWithKeysAndRef,\n  ensureKeyOrUndefined,\n  simulateError,\n  wrap,\n  getMaskedContext,\n  getComponentStack,\n  RootFinder,\n  getNodeFromRootFinder,\n  wrapWithWrappingComponent,\n  getWrappingComponentMountRenderer,\n  compareNodeTypeOf,\n  spyMethod,\n  getPublicRootInstance,\n  TAG_CODES,\n} from '@chalbert/enzyme-adapter-utils';\nimport findCurrentFiberUsingSlowPath from './findCurrentFiberUsingSlowPath';\n\n// Lazily populated if DOM is available.\n\nfunction nodeAndSiblingsArray(nodeWithSibling) {\n  const array = [];\n  let node = nodeWithSibling;\n  while (node != null) {\n    array.push(node);\n    node = node.sibling;\n  }\n  return array;\n}\n\nfunction flatten(arr) {\n  const result = [];\n  const stack = [{ i: 0, array: arr }];\n  while (stack.length) {\n    const n = stack.pop();\n    while (n.i < n.array.length) {\n      const el = n.array[n.i];\n      n.i += 1;\n      if (Array.isArray(el)) {\n        stack.push(n);\n        stack.push({ i: 0, array: el });\n        break;\n      }\n      result.push(el);\n    }\n  }\n  return result;\n}\n\nfunction nodeTypeFromType(type) {\n  if (type === Portal) {\n    return 'portal';\n  }\n\n  return utilNodeTypeFromType(type);\n}\n\nfunction isMemo(type) {\n  return compareNodeTypeOf(type, Memo);\n}\n\nfunction isLazy(type) {\n  return compareNodeTypeOf(type, Lazy);\n}\n\nfunction unmemoType(type) {\n  return isMemo(type) ? type.type : type;\n}\n\nfunction checkIsSuspenseAndCloneElement(el, { suspenseFallback }) {\n  if (!isSuspense(el)) {\n    return el;\n  }\n\n  let { children } = el.props;\n\n  if (suspenseFallback) {\n    const { fallback } = el.props;\n    children = replaceLazyWithFallback(children, fallback);\n  }\n\n  const FakeSuspenseWrapper = (props) =>\n    React.createElement(el.type, { ...el.props, ...props }, children);\n  return React.createElement(FakeSuspenseWrapper, null, children);\n}\n\nfunction elementToTree(el) {\n  if (!isPortal(el)) {\n    return utilElementToTree(el, elementToTree);\n  }\n\n  const { children, containerInfo } = el;\n  const props = { children, containerInfo };\n\n  return {\n    nodeType: 'portal',\n    type: Portal,\n    props,\n    key: ensureKeyOrUndefined(el.key),\n    ref: el.ref || null,\n    instance: null,\n    rendered: elementToTree(el.children),\n  };\n}\n\nfunction toTree(vnode) {\n  if (vnode == null) {\n    return null;\n  }\n  // TODO(lmr): I'm not really sure I understand whether or not this is what\n  // i should be doing, or if this is a hack for something i'm doing wrong\n  // somewhere else. Should talk to sebastian about this perhaps\n  const node = findCurrentFiberUsingSlowPath(vnode);\n\n  switch (node.tag) {\n    case TAG_CODES.HostRoot:\n      return childrenToTree(node.child);\n    case TAG_CODES.HostPortal: {\n      const {\n        stateNode: { containerInfo },\n        memoizedProps: children,\n      } = node;\n      const props = { containerInfo, children };\n      return {\n        nodeType: 'portal',\n        type: Portal,\n        props,\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: null,\n        rendered: childrenToTree(node.child),\n      };\n    }\n    case TAG_CODES.IndeterminateComponent:\n      return {\n        nodeType: 'indeterminate',\n        type: node.type,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: node.stateNode,\n        rendered: childrenToTree(node.child),\n      };\n    case TAG_CODES.IncompleteClassComponent:\n    case TAG_CODES.ClassComponent:\n      return {\n        nodeType: 'class',\n        type: node.type,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: node.stateNode,\n        rendered: childrenToTree(node.child),\n      };\n    case TAG_CODES.FunctionComponent:\n      return {\n        nodeType: 'function',\n        type: node.type,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: null,\n        rendered: childrenToTree(node.child),\n      };\n    case TAG_CODES.MemoClass:\n      return {\n        nodeType: 'class',\n        type: node.elementType.type,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: node.stateNode,\n        rendered: childrenToTree(node.child.child),\n      };\n    case TAG_CODES.MemoSFC: {\n      let renderedNodes = flatten(nodeAndSiblingsArray(node.child).map(toTree));\n      if (renderedNodes.length === 0) {\n        renderedNodes = [node.memoizedProps.children];\n      }\n      return {\n        nodeType: 'function',\n        type: node.elementType,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: null,\n        rendered: renderedNodes,\n      };\n    }\n    case TAG_CODES.HostComponent: {\n      let renderedNodes = flatten(nodeAndSiblingsArray(node.child).map(toTree));\n      if (renderedNodes.length === 0) {\n        renderedNodes = [node.memoizedProps.children];\n      }\n      return {\n        nodeType: 'host',\n        type: node.type,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: node.stateNode,\n        rendered: renderedNodes,\n      };\n    }\n    case TAG_CODES.HostText:\n      return node.memoizedProps;\n    case TAG_CODES.DehydratedFragment:\n    case TAG_CODES.Fragment:\n    case TAG_CODES.Mode:\n    case TAG_CODES.ContextProvider:\n    case TAG_CODES.ContextConsumer:\n      return childrenToTree(node.child);\n    case TAG_CODES.Profiler:\n    case TAG_CODES.MemoComponent:\n    case TAG_CODES.SimpleMemoComponent:\n    case TAG_CODES.ForwardRef: {\n      return {\n        nodeType: 'function',\n        type: node.type,\n        props: { ...node.pendingProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: null,\n        rendered: childrenToTree(node.child),\n      };\n    }\n    case TAG_CODES.SuspenseListComponent:\n    case TAG_CODES.SuspenseComponent: {\n      const children = flatten(nodeAndSiblingsArray(node.child.child).map(toTree));\n\n      return {\n        nodeType: 'function',\n        type: Suspense,\n        props: { ...node.memoizedProps },\n        key: ensureKeyOrUndefined(node.key),\n        ref: node.ref,\n        instance: null,\n        rendered: children.length ? children : childrenToTree(node.child),\n      };\n    }\n    case TAG_CODES.LazyComponent:\n      return childrenToTree(node.child);\n    case TAG_CODES.ScopeComponent:\n    case TAG_CODES.OffscreenComponent:\n    case TAG_CODES.LegacyHiddenComponent:\n    case TAG_CODES.CacheComponent:\n    case TAG_CODES.TracingMarkerComponent:\n      return toTree(node.child);\n    default:\n      throw new Error(`Enzyme Internal Error: unknown node with tag ${node.tag}`);\n  }\n}\n\nfunction childrenToTree(node) {\n  if (!node) {\n    return null;\n  }\n  const children = nodeAndSiblingsArray(node);\n  if (children.length === 0) {\n    return null;\n  }\n  if (children.length === 1) {\n    return toTree(children[0]);\n  }\n  return flatten(children.map(toTree));\n}\n\nfunction nodeToHostNode(_node) {\n  // NOTE(lmr): node could be a function component\n  // which wont have an instance prop, but we can get the\n  // host node associated with its return value at that point.\n  // Although this breaks down if the return value is an array,\n  // as is possible with React 16.\n  let node = _node;\n  while (node && !Array.isArray(node) && node.instance === null) {\n    node = node.rendered;\n  }\n  // if the SFC returned null effectively, there is no host node.\n  if (!node) {\n    return null;\n  }\n\n  const mapper = (item) => {\n    if (item && item.instance) return findDOMNode(item.instance);\n    return null;\n  };\n  if (Array.isArray(node)) {\n    return node.map(mapper);\n  }\n  if (Array.isArray(node.rendered) && node.nodeType === 'class') {\n    return node.rendered.map(mapper);\n  }\n  return mapper(node);\n}\n\nfunction replaceLazyWithFallback(node, fallback) {\n  if (!node) {\n    return null;\n  }\n  if (Array.isArray(node)) {\n    return node.map((el) => replaceLazyWithFallback(el, fallback));\n  }\n  if (isLazy(node.type)) {\n    // console.log('-----------------replaceLazyWithFallback');\n    return fallback;\n  }\n  return {\n    ...node,\n    props: {\n      ...node.props,\n      children: replaceLazyWithFallback(node.props.children, fallback),\n    },\n  };\n}\n\nfunction getEmptyStateValue() {\n  // this handles a bug in React 16.0 - 16.2\n  // see https://github.com/facebook/react/commit/39be83565c65f9c522150e52375167568a2a1459\n  // also see https://github.com/facebook/react/pull/11965\n\n  class EmptyState extends React.Component {\n    render() {\n      return null;\n    }\n  }\n  const testRenderer = new ShallowRenderer();\n  testRenderer.render(React.createElement(EmptyState));\n  return testRenderer._instance.state;\n}\n\nfunction wrapAct(fn) {\n  let returnVal;\n  TestUtils.act(() => {\n    returnVal = fn();\n  });\n  return returnVal;\n}\n\nfunction getProviderDefaultValue(Provider) {\n  // React stores references to the Provider's defaultValue differently across versions.\n  if ('_defaultValue' in Provider._context) {\n    return Provider._context._defaultValue;\n  }\n  if ('_currentValue' in Provider._context) {\n    return Provider._context._currentValue;\n  }\n  throw new Error('Enzyme Internal Error: can’t figure out how to get Provider’s default value');\n}\n\nfunction makeFakeElement(type) {\n  return { $$typeof: Element, type };\n}\n\nfunction isStateful(Component) {\n  return (\n    Component.prototype &&\n    (Component.prototype.isReactComponent || Array.isArray(Component.__reactAutoBindPairs)) // fallback for createClass components\n  );\n}\n\nclass ReactEighteenAdapter extends EnzymeAdapter {\n  constructor() {\n    super();\n\n    // Monkey patching so we don't have to wrap in 'act' each time\n    const { setProps, setState } = ReactWrapper.prototype;\n    ReactWrapper.prototype.setProps = function (...args) {\n      return wrapAct(() => setProps.apply(this, args));\n    };\n    ReactWrapper.prototype.setState = function (...args) {\n      return wrapAct(() => setState.apply(this, args));\n    };\n\n    const { lifecycles } = this.options;\n    this.options = {\n      ...this.options,\n      enableComponentDidUpdateOnSetState: true, // TODO: remove, semver-major\n      legacyContextMode: 'parent',\n      lifecycles: {\n        ...lifecycles,\n        componentDidUpdate: {\n          onSetState: true,\n        },\n        getDerivedStateFromProps: {\n          hasShouldComponentUpdateBug: false,\n        },\n        getSnapshotBeforeUpdate: true,\n        setState: {\n          skipsComponentDidUpdateOnNullish: true,\n        },\n        getChildContext: {\n          calledByRenderer: false,\n        },\n        getDerivedStateFromError: true,\n      },\n    };\n  }\n\n  createMountRenderer(options) {\n    assertDomAvailable('mount');\n    if (has(options, 'suspenseFallback')) {\n      throw new TypeError('`suspenseFallback` is not supported by the `mount` renderer');\n    }\n\n    const { attachTo, hydrateIn, wrappingComponentProps } = options;\n    const domNode = hydrateIn || attachTo || global.document.createElement('div');\n    let instance = null;\n    const adapter = this;\n\n    let root;\n\n    return {\n      render(el, context, callback) {\n        return wrapAct(() => {\n          if (instance === null) {\n            const { type, props, ref } = el;\n            const wrapperProps = {\n              Component: type,\n              props,\n              wrappingComponentProps,\n              context,\n              ...(ref && { refProp: ref }),\n            };\n\n            let wrappedEl;\n\n            const ReactWrapperComponent = createMountWrapper(el, { ...options, adapter });\n            wrappedEl = React.createElement(ReactWrapperComponent, wrapperProps);\n            root = hydrateIn ? hydrateRoot(domNode, wrappedEl) : createRoot(domNode);\n\n            flushSync(() => {\n              root.render(wrappedEl);\n            });\n\n            instance = getPublicRootInstance(root);\n\n            if (typeof callback === 'function') {\n              callback();\n            }\n          } else {\n            instance.setChildProps(el.props, context, callback);\n          }\n        });\n      },\n      unmount() {\n        wrapAct(() => {\n          root?.unmount();\n        });\n        instance = null;\n      },\n      getNode() {\n        if (!instance) {\n          return null;\n        }\n        return getNodeFromRootFinder(\n          adapter.isCustomComponent,\n          toTree(instance._reactInternals),\n          options,\n        );\n      },\n      simulateError(nodeHierarchy, rootNode, error) {\n        const isErrorBoundary = ({ instance: elInstance, type }) => {\n          if (type && type.getDerivedStateFromError) {\n            return true;\n          }\n          return elInstance && elInstance.componentDidCatch;\n        };\n\n        const { instance: catchingInstance, type: catchingType } =\n          nodeHierarchy.find(isErrorBoundary) || {};\n\n        TestUtils.act(() => {\n          simulateError(\n            error,\n            catchingInstance,\n            rootNode,\n            nodeHierarchy,\n            nodeTypeFromType,\n            adapter.displayNameOfNode,\n            catchingType,\n          );\n        });\n      },\n      simulateEvent(node, event, mock) {\n        const mappedEvent = mapNativeEventNames(event);\n        const eventFn = TestUtils.Simulate[mappedEvent];\n        if (!eventFn) {\n          throw new TypeError(`ReactWrapper::simulate() event '${event}' does not exist`);\n        }\n        wrapAct(() => {\n          eventFn(adapter.nodeToHostNode(node), mock);\n        });\n      },\n      batchedUpdates(fn) {\n        return fn();\n      },\n      getWrappingComponentRenderer() {\n        return {\n          ...this,\n          ...getWrappingComponentMountRenderer({\n            toTree: (inst) => toTree(inst._reactInternals),\n            getMountWrapperInstance: () => instance,\n          }),\n        };\n      },\n      wrapInvoke: wrapAct,\n    };\n  }\n\n  createShallowRenderer(options = {}) {\n    const adapter = this;\n    const renderer = new ShallowRenderer();\n    const { suspenseFallback } = options;\n    if (typeof suspenseFallback !== 'undefined' && typeof suspenseFallback !== 'boolean') {\n      throw TypeError('`options.suspenseFallback` should be boolean or undefined');\n    }\n    let isDOM = false;\n    let cachedNode = null;\n\n    let lastComponent = null;\n    let wrappedComponent = null;\n    const sentinel = {};\n\n    // wrap memo components with a PureComponent, or a class component with sCU\n    const wrapPureComponent = (Component, compare) => {\n      if (lastComponent !== Component) {\n        if (isStateful(Component)) {\n          wrappedComponent = class extends Component {};\n          if (compare) {\n            wrappedComponent.prototype.shouldComponentUpdate = (nextProps) =>\n              !compare(this.props, nextProps);\n          } else {\n            wrappedComponent.prototype.isPureReactComponent = true;\n          }\n        } else {\n          let memoized = sentinel;\n          let prevProps;\n          wrappedComponent = function wrappedComponentFn(props, ...args) {\n            const shouldUpdate =\n              memoized === sentinel ||\n              (compare ? !compare(prevProps, props) : !shallowEqual(prevProps, props));\n            if (shouldUpdate) {\n              memoized = Component({ ...Component.defaultProps, ...props }, ...args);\n              prevProps = props;\n            }\n            return memoized;\n          };\n        }\n        Object.assign(wrappedComponent, Component, {\n          displayName: adapter.displayNameOfNode({ type: Component }),\n        });\n        lastComponent = Component;\n      }\n      return wrappedComponent;\n    };\n\n    // Wrap functional components on versions prior to 16.5,\n    // to avoid inadvertently pass a `this` instance to it.\n    const wrapFunctionalComponent = (Component) => {\n      if (has(Component, 'defaultProps')) {\n        if (lastComponent !== Component) {\n          wrappedComponent = Object.assign(\n            (props, ...args) => Component({ ...Component.defaultProps, ...props }, ...args),\n            Component,\n            { displayName: adapter.displayNameOfNode({ type: Component }) },\n          );\n          lastComponent = Component;\n        }\n        return wrappedComponent;\n      }\n\n      return Component;\n    };\n\n    const renderElement = (elConfig, ...rest) => {\n      // console.log('**************** renderElement');\n      const renderedEl = renderer.render(elConfig, ...rest);\n\n      const typeIsExisted = !!(renderedEl && renderedEl.type);\n      if (typeIsExisted) {\n        const clonedEl = checkIsSuspenseAndCloneElement(renderedEl, { suspenseFallback });\n\n        const elementIsChanged = clonedEl.type !== renderedEl.type;\n        if (elementIsChanged) {\n          return renderer.render({ ...elConfig, type: clonedEl.type }, ...rest);\n        }\n      }\n\n      return renderedEl;\n    };\n\n    return {\n      render(el, unmaskedContext, { providerValues = new Map() } = {}) {\n        cachedNode = el;\n        if (typeof el.type === 'string') {\n          isDOM = true;\n        } else if (isContextProvider(el)) {\n          providerValues.set(el.type, el.props.value);\n          const MockProvider = Object.assign((props) => props.children, el.type);\n          return withSetStateAllowed(() => renderElement({ ...el, type: MockProvider }));\n        } else if (isContextConsumer(el)) {\n          const Provider = adapter.getProviderFromConsumer(el.type);\n          const value = providerValues.has(Provider)\n            ? providerValues.get(Provider)\n            : getProviderDefaultValue(Provider);\n          const MockConsumer = Object.assign((props) => props.children(value), el.type);\n          return withSetStateAllowed(() => renderElement({ ...el, type: MockConsumer }));\n        } else {\n          isDOM = false;\n          let renderedEl = el;\n          if (isLazy(renderedEl)) {\n            throw TypeError('`React.lazy` is not supported by shallow rendering.');\n          }\n\n          renderedEl = checkIsSuspenseAndCloneElement(renderedEl, { suspenseFallback });\n          const { type: Component } = renderedEl;\n\n          const context = getMaskedContext(Component.contextTypes, unmaskedContext);\n\n          if (isMemo(el.type)) {\n            const { type: InnerComp, compare } = el.type;\n\n            return withSetStateAllowed(() =>\n              renderElement({ ...el, type: wrapPureComponent(InnerComp, compare) }, context),\n            );\n          }\n\n          const isComponentStateful = isStateful(Component);\n\n          if (!isComponentStateful && typeof Component === 'function') {\n            return withSetStateAllowed(() =>\n              renderElement({ ...renderedEl, type: wrapFunctionalComponent(Component) }, context),\n            );\n          }\n\n          if (isComponentStateful) {\n            if (\n              renderer._instance &&\n              el.props === renderer._instance.props &&\n              !shallowEqual(context, renderer._instance.context)\n            ) {\n              const { restore } = spyMethod(\n                renderer,\n                '_updateClassComponent',\n                (originalMethod) =>\n                  function _updateClassComponent(...args) {\n                    const { props } = renderer._instance;\n                    const clonedProps = { ...props };\n                    renderer._instance.props = clonedProps;\n\n                    const result = originalMethod.apply(renderer, args);\n\n                    renderer._instance.props = props;\n                    restore();\n\n                    return result;\n                  },\n              );\n            }\n\n            // fix react bug; see implementation of `getEmptyStateValue`\n            const emptyStateValue = getEmptyStateValue();\n            if (emptyStateValue) {\n              Object.defineProperty(Component.prototype, 'state', {\n                configurable: true,\n                enumerable: true,\n                get() {\n                  return null;\n                },\n                set(value) {\n                  if (value !== emptyStateValue) {\n                    Object.defineProperty(this, 'state', {\n                      configurable: true,\n                      enumerable: true,\n                      value,\n                      writable: true,\n                    });\n                  }\n                },\n              });\n            }\n          }\n          return withSetStateAllowed(() => renderElement(renderedEl, context));\n        }\n      },\n      unmount() {\n        renderer.unmount();\n      },\n      getNode() {\n        if (isDOM) {\n          return elementToTree(cachedNode);\n        }\n        const output = renderer.getRenderOutput();\n        return {\n          nodeType: nodeTypeFromType(cachedNode.type),\n          type: cachedNode.type,\n          props: cachedNode.props,\n          key: ensureKeyOrUndefined(cachedNode.key),\n          ref: cachedNode.ref,\n          instance: renderer._instance,\n          rendered: Array.isArray(output)\n            ? flatten(output).map((el) => elementToTree(el))\n            : elementToTree(output),\n        };\n      },\n      simulateError(nodeHierarchy, rootNode, error) {\n        simulateError(\n          error,\n          renderer._instance,\n          cachedNode,\n          nodeHierarchy.concat(cachedNode),\n          nodeTypeFromType,\n          adapter.displayNameOfNode,\n          cachedNode.type,\n        );\n      },\n      simulateEvent(node, event, ...args) {\n        const handler = node.props[propFromEvent(event)];\n        if (handler) {\n          withSetStateAllowed(() => {\n            // TODO(lmr): create/use synthetic events\n            // TODO(lmr): emulate React's event propagation\n            handler(...args);\n          });\n        }\n      },\n      batchedUpdates(fn) {\n        return fn();\n      },\n      checkPropTypes(typeSpecs, values, location, hierarchy) {\n        return checkPropTypes(typeSpecs, values, location, displayNameOfNode(cachedNode), () =>\n          getComponentStack(hierarchy.concat([cachedNode])),\n        );\n      },\n    };\n  }\n\n  createStringRenderer(options) {\n    if (has(options, 'suspenseFallback')) {\n      throw new TypeError(\n        '`suspenseFallback` should not be specified in options of string renderer',\n      );\n    }\n    return {\n      render(el, context) {\n        if (options.context && (el.type.contextTypes || options.childContextTypes)) {\n          const childContextTypes = {\n            ...(el.type.contextTypes || {}),\n            ...options.childContextTypes,\n          };\n          const ContextWrapper = createRenderWrapper(el, context, childContextTypes);\n          return ReactDOMServer.renderToStaticMarkup(React.createElement(ContextWrapper));\n        }\n        return ReactDOMServer.renderToStaticMarkup(el);\n      },\n    };\n  }\n\n  // Provided a bag of options, return an `EnzymeRenderer`. Some options can be implementation\n  // specific, like `attach` etc. for React, but not part of this interface explicitly.\n  createRenderer(options) {\n    switch (options.mode) {\n      case EnzymeAdapter.MODES.MOUNT:\n        return this.createMountRenderer(options);\n      case EnzymeAdapter.MODES.SHALLOW:\n        return this.createShallowRenderer(options);\n      case EnzymeAdapter.MODES.STRING:\n        return this.createStringRenderer(options);\n      default:\n        throw new Error(`Enzyme Internal Error: Unrecognized mode: ${options.mode}`);\n    }\n  }\n\n  wrap(element) {\n    return wrap(element);\n  }\n\n  // converts an RSTNode to the corresponding JSX Pragma Element. This will be needed\n  // in order to implement the `Wrapper.mount()` and `Wrapper.shallow()` methods, but should\n  // be pretty straightforward for people to implement.\n  nodeToElement(node) {\n    if (!node || typeof node !== 'object') return null;\n    const { type } = node;\n    return React.createElement(unmemoType(type), propsWithKeysAndRef(node));\n  }\n\n  matchesElementType(node, matchingType) {\n    if (!node) {\n      return node;\n    }\n    const { type } = node;\n    return unmemoType(type) === unmemoType(matchingType);\n  }\n\n  elementToNode(element) {\n    return elementToTree(element);\n  }\n\n  nodeToHostNode(node, supportsArray = false) {\n    const nodes = nodeToHostNode(node);\n    if (Array.isArray(nodes) && !supportsArray) {\n      // get the first non-null node\n      return nodes.filter(Boolean)[0];\n    }\n    return nodes;\n  }\n\n  displayNameOfNode(node) {\n    if (!node) return null;\n    const { type, $$typeof } = node;\n    const adapter = this;\n\n    const nodeType = type || $$typeof;\n\n    // newer node types may be undefined, so only test if the nodeType exists\n    if (nodeType) {\n      switch (nodeType) {\n        case ConcurrentMode || NaN:\n          return 'ConcurrentMode';\n        case Fragment || NaN:\n          return 'Fragment';\n        case StrictMode || NaN:\n          return 'StrictMode';\n        case Profiler || NaN:\n          return 'Profiler';\n        case Portal || NaN:\n          return 'Portal';\n        case Suspense || NaN:\n          return 'Suspense';\n        default:\n      }\n    }\n\n    const $$typeofType = type && type.$$typeof;\n\n    switch ($$typeofType) {\n      case ContextConsumer || NaN:\n        return 'ContextConsumer';\n      case ContextProvider || NaN:\n        return 'ContextProvider';\n      case Memo || NaN: {\n        const nodeName = displayNameOfNode(node);\n        return typeof nodeName === 'string' ? nodeName : `Memo(${adapter.displayNameOfNode(type)})`;\n      }\n      case ForwardRef || NaN: {\n        if (type.displayName) {\n          return type.displayName;\n        }\n        const name = adapter.displayNameOfNode({ type: type.render });\n        return name ? `ForwardRef(${name})` : 'ForwardRef';\n      }\n      case Lazy || NaN: {\n        return 'lazy';\n      }\n      default:\n        return displayNameOfNode(node);\n    }\n  }\n\n  isValidElement(element) {\n    return isElement(element);\n  }\n\n  isValidElementType(object) {\n    return !!object && isValidElementType(object);\n  }\n\n  isFragment(fragment) {\n    return typeOfNode(fragment) === Fragment;\n  }\n\n  isCustomComponent(type) {\n    const fakeElement = makeFakeElement(type);\n    return (\n      !!type &&\n      (typeof type === 'function' ||\n        isForwardRef(fakeElement) ||\n        isContextProvider(fakeElement) ||\n        isContextConsumer(fakeElement) ||\n        isSuspense(fakeElement))\n    );\n  }\n\n  isContextConsumer(type) {\n    return !!type && isContextConsumer(makeFakeElement(type));\n  }\n\n  isCustomComponentElement(inst) {\n    if (!inst || !this.isValidElement(inst)) {\n      return false;\n    }\n    return this.isCustomComponent(inst.type);\n  }\n\n  getProviderFromConsumer(Consumer) {\n    // React stores references to the Provider on a Consumer differently across versions.\n    if (Consumer) {\n      let Provider;\n      if (Consumer._context) {\n        // check this first, to avoid a deprecation warning\n        ({ Provider } = Consumer._context);\n      } else if (Consumer.Provider) {\n        ({ Provider } = Consumer);\n      }\n      if (Provider) {\n        return Provider;\n      }\n    }\n    throw new Error('Enzyme Internal Error: can’t figure out how to get Provider from Consumer');\n  }\n\n  createElement(...args) {\n    return wrapAct(() => React.createElement(...args));\n  }\n\n  wrapWithWrappingComponent(node, options) {\n    return {\n      RootFinder,\n      node: wrapWithWrappingComponent(React.createElement, node, options),\n    };\n  }\n}\n\nmodule.exports = ReactEighteenAdapter;\n"],"mappings":";;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAqBA;;AACA;;AACA;;AACA;;AAyBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;AAEA,SAASA,oBAAT,CAA8BC,eAA9B,EAA+C;EAC7C,IAAMC,KAAK,GAAG,EAAd;EACA,IAAIC,IAAI,GAAGF,eAAX;;EACA,OAAOE,IAAI,IAAI,IAAf,EAAqB;IACnBD,KAAK,CAACE,IAAN,CAAWD,IAAX;IACAA,IAAI,GAAGA,IAAI,CAACE,OAAZ;EACD;;EACD,OAAOH,KAAP;AACD;;AAED,SAASI,OAAT,CAAiBC,GAAjB,EAAsB;EACpB,IAAMC,MAAM,GAAG,EAAf;EACA,IAAMC,KAAK,GAAG,CAAC;IAAEC,CAAC,EAAE,CAAL;IAAQR,KAAK,EAAEK;EAAf,CAAD,CAAd;;EACA,OAAOE,KAAK,CAACE,MAAb,EAAqB;IACnB,IAAMC,CAAC,GAAGH,KAAK,CAACI,GAAN,EAAV;;IACA,OAAOD,CAAC,CAACF,CAAF,GAAME,CAAC,CAACV,KAAF,CAAQS,MAArB,EAA6B;MAC3B,IAAMG,EAAE,GAAGF,CAAC,CAACV,KAAF,CAAQU,CAAC,CAACF,CAAV,CAAX;MACAE,CAAC,CAACF,CAAF,IAAO,CAAP;;MACA,IAAIK,KAAK,CAACC,OAAN,CAAcF,EAAd,CAAJ,EAAuB;QACrBL,KAAK,CAACL,IAAN,CAAWQ,CAAX;QACAH,KAAK,CAACL,IAAN,CAAW;UAAEM,CAAC,EAAE,CAAL;UAAQR,KAAK,EAAEY;QAAf,CAAX;QACA;MACD;;MACDN,MAAM,CAACJ,IAAP,CAAYU,EAAZ;IACD;EACF;;EACD,OAAON,MAAP;AACD;;AAED,SAASS,gBAAT,CAA0BC,IAA1B,EAAgC;EAC9B,IAAIA,IAAI,KAAKC,eAAb,EAAqB;IACnB,OAAO,QAAP;EACD;;EAED,OAAO,IAAAC,oCAAA,EAAqBF,IAArB,CAAP;AACD;;AAED,SAASG,MAAT,CAAgBH,IAAhB,EAAsB;EACpB,OAAO,IAAAI,qCAAA,EAAkBJ,IAAlB,EAAwBK,aAAxB,CAAP;AACD;;AAED,SAASC,MAAT,CAAgBN,IAAhB,EAAsB;EACpB,OAAO,IAAAI,qCAAA,EAAkBJ,IAAlB,EAAwBO,aAAxB,CAAP;AACD;;AAED,SAASC,UAAT,CAAoBR,IAApB,EAA0B;EACxB,OAAOG,MAAM,CAACH,IAAD,CAAN,GAAeA,IAAI,CAACA,IAApB,GAA2BA,IAAlC;AACD;;AAED,SAASS,8BAAT,CAAwCb,EAAxC,QAAkE;EAAA,IAApBc,gBAAoB,QAApBA,gBAAoB;;EAChE,IAAI,CAAC,IAAAC,mBAAA,EAAWf,EAAX,CAAL,EAAqB;IACnB,OAAOA,EAAP;EACD;;EAED,IAAMgB,QAAN,GAAmBhB,EAAE,CAACiB,KAAtB,CAAMD,QAAN;;EAEA,IAAIF,gBAAJ,EAAsB;IACpB,IAAQI,QAAR,GAAqBlB,EAAE,CAACiB,KAAxB,CAAQC,QAAR;IACAF,QAAQ,GAAGG,uBAAuB,CAACH,QAAD,EAAWE,QAAX,CAAlC;EACD;;EAED,IAAME,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACH,KAAD;IAAA,oBAC1BI,iBAAA,CAAMC,aAAN,CAAoBtB,EAAE,CAACI,IAAvB,kCAAkCJ,EAAE,CAACiB,KAArC,GAA+CA,KAA/C,GAAwDD,QAAxD,CAD0B;EAAA,CAA5B;;EAEA,oBAAOK,iBAAA,CAAMC,aAAN,CAAoBF,mBAApB,EAAyC,IAAzC,EAA+CJ,QAA/C,CAAP;AACD;;AAED,SAASO,aAAT,CAAuBvB,EAAvB,EAA2B;EACzB,IAAI,CAAC,IAAAwB,iBAAA,EAASxB,EAAT,CAAL,EAAmB;IACjB,OAAO,IAAAyB,iCAAA,EAAkBzB,EAAlB,EAAsBuB,aAAtB,CAAP;EACD;;EAED,IAAQP,QAAR,GAAoChB,EAApC,CAAQgB,QAAR;EAAA,IAAkBU,aAAlB,GAAoC1B,EAApC,CAAkB0B,aAAlB;EACA,IAAMT,KAAK,GAAG;IAAED,QAAQ,EAARA,QAAF;IAAYU,aAAa,EAAbA;EAAZ,CAAd;EAEA,OAAO;IACLC,QAAQ,EAAE,QADL;IAELvB,IAAI,EAAEC,eAFD;IAGLY,KAAK,EAALA,KAHK;IAILW,GAAG,EAAE,IAAAC,wCAAA,EAAqB7B,EAAE,CAAC4B,GAAxB,CAJA;IAKLE,GAAG,EAAE9B,EAAE,CAAC8B,GAAH,IAAU,IALV;IAMLC,QAAQ,EAAE,IANL;IAOLC,QAAQ,EAAET,aAAa,CAACvB,EAAE,CAACgB,QAAJ;EAPlB,CAAP;AASD;;AAED,SAASiB,OAAT,CAAgBC,KAAhB,EAAuB;EACrB,IAAIA,KAAK,IAAI,IAAb,EAAmB;IACjB,OAAO,IAAP;EACD,CAHoB,CAIrB;EACA;EACA;;;EACA,IAAM7C,IAAI,GAAG,IAAA8C,yCAAA,EAA8BD,KAA9B,CAAb;;EAEA,QAAQ7C,IAAI,CAAC+C,GAAb;IACE,KAAKC,6BAAA,CAAUC,QAAf;MACE,OAAOC,cAAc,CAAClD,IAAI,CAACmD,KAAN,CAArB;;IACF,KAAKH,6BAAA,CAAUI,UAAf;MAA2B;QACzB,IACef,aADf,GAGIrC,IAHJ,CACEqD,SADF,CACehB,aADf;QAAA,IAEiBV,QAFjB,GAGI3B,IAHJ,CAEEsD,aAFF;QAIA,IAAM1B,KAAK,GAAG;UAAES,aAAa,EAAbA,aAAF;UAAiBV,QAAQ,EAARA;QAAjB,CAAd;QACA,OAAO;UACLW,QAAQ,EAAE,QADL;UAELvB,IAAI,EAAEC,eAFD;UAGLY,KAAK,EAALA,KAHK;UAILW,GAAG,EAAE,IAAAC,wCAAA,EAAqBxC,IAAI,CAACuC,GAA1B,CAJA;UAKLE,GAAG,EAAEzC,IAAI,CAACyC,GALL;UAMLC,QAAQ,EAAE,IANL;UAOLC,QAAQ,EAAEO,cAAc,CAAClD,IAAI,CAACmD,KAAN;QAPnB,CAAP;MASD;;IACD,KAAKH,6BAAA,CAAUO,sBAAf;MACE,OAAO;QACLjB,QAAQ,EAAE,eADL;QAELvB,IAAI,EAAEf,IAAI,CAACe,IAFN;QAGLa,KAAK,oBAAO5B,IAAI,CAACsD,aAAZ,CAHA;QAILf,GAAG,EAAE,IAAAC,wCAAA,EAAqBxC,IAAI,CAACuC,GAA1B,CAJA;QAKLE,GAAG,EAAEzC,IAAI,CAACyC,GALL;QAMLC,QAAQ,EAAE1C,IAAI,CAACqD,SANV;QAOLV,QAAQ,EAAEO,cAAc,CAAClD,IAAI,CAACmD,KAAN;MAPnB,CAAP;;IASF,KAAKH,6BAAA,CAAUQ,wBAAf;IACA,KAAKR,6BAAA,CAAUS,cAAf;MACE,OAAO;QACLnB,QAAQ,EAAE,OADL;QAELvB,IAAI,EAAEf,IAAI,CAACe,IAFN;QAGLa,KAAK,oBAAO5B,IAAI,CAACsD,aAAZ,CAHA;QAILf,GAAG,EAAE,IAAAC,wCAAA,EAAqBxC,IAAI,CAACuC,GAA1B,CAJA;QAKLE,GAAG,EAAEzC,IAAI,CAACyC,GALL;QAMLC,QAAQ,EAAE1C,IAAI,CAACqD,SANV;QAOLV,QAAQ,EAAEO,cAAc,CAAClD,IAAI,CAACmD,KAAN;MAPnB,CAAP;;IASF,KAAKH,6BAAA,CAAUU,iBAAf;MACE,OAAO;QACLpB,QAAQ,EAAE,UADL;QAELvB,IAAI,EAAEf,IAAI,CAACe,IAFN;QAGLa,KAAK,oBAAO5B,IAAI,CAACsD,aAAZ,CAHA;QAILf,GAAG,EAAE,IAAAC,wCAAA,EAAqBxC,IAAI,CAACuC,GAA1B,CAJA;QAKLE,GAAG,EAAEzC,IAAI,CAACyC,GALL;QAMLC,QAAQ,EAAE,IANL;QAOLC,QAAQ,EAAEO,cAAc,CAAClD,IAAI,CAACmD,KAAN;MAPnB,CAAP;;IASF,KAAKH,6BAAA,CAAUW,SAAf;MACE,OAAO;QACLrB,QAAQ,EAAE,OADL;QAELvB,IAAI,EAAEf,IAAI,CAAC4D,WAAL,CAAiB7C,IAFlB;QAGLa,KAAK,oBAAO5B,IAAI,CAACsD,aAAZ,CAHA;QAILf,GAAG,EAAE,IAAAC,wCAAA,EAAqBxC,IAAI,CAACuC,GAA1B,CAJA;QAKLE,GAAG,EAAEzC,IAAI,CAACyC,GALL;QAMLC,QAAQ,EAAE1C,IAAI,CAACqD,SANV;QAOLV,QAAQ,EAAEO,cAAc,CAAClD,IAAI,CAACmD,KAAL,CAAWA,KAAZ;MAPnB,CAAP;;IASF,KAAKH,6BAAA,CAAUa,OAAf;MAAwB;QACtB,IAAIC,aAAa,GAAG3D,OAAO,CAACN,oBAAoB,CAACG,IAAI,CAACmD,KAAN,CAApB,CAAiCY,GAAjC,CAAqCnB,OAArC,CAAD,CAA3B;;QACA,IAAIkB,aAAa,CAACtD,MAAd,KAAyB,CAA7B,EAAgC;UAC9BsD,aAAa,GAAG,CAAC9D,IAAI,CAACsD,aAAL,CAAmB3B,QAApB,CAAhB;QACD;;QACD,OAAO;UACLW,QAAQ,EAAE,UADL;UAELvB,IAAI,EAAEf,IAAI,CAAC4D,WAFN;UAGLhC,KAAK,oBAAO5B,IAAI,CAACsD,aAAZ,CAHA;UAILf,GAAG,EAAE,IAAAC,wCAAA,EAAqBxC,IAAI,CAACuC,GAA1B,CAJA;UAKLE,GAAG,EAAEzC,IAAI,CAACyC,GALL;UAMLC,QAAQ,EAAE,IANL;UAOLC,QAAQ,EAAEmB;QAPL,CAAP;MASD;;IACD,KAAKd,6BAAA,CAAUgB,aAAf;MAA8B;QAC5B,IAAIF,cAAa,GAAG3D,OAAO,CAACN,oBAAoB,CAACG,IAAI,CAACmD,KAAN,CAApB,CAAiCY,GAAjC,CAAqCnB,OAArC,CAAD,CAA3B;;QACA,IAAIkB,cAAa,CAACtD,MAAd,KAAyB,CAA7B,EAAgC;UAC9BsD,cAAa,GAAG,CAAC9D,IAAI,CAACsD,aAAL,CAAmB3B,QAApB,CAAhB;QACD;;QACD,OAAO;UACLW,QAAQ,EAAE,MADL;UAELvB,IAAI,EAAEf,IAAI,CAACe,IAFN;UAGLa,KAAK,oBAAO5B,IAAI,CAACsD,aAAZ,CAHA;UAILf,GAAG,EAAE,IAAAC,wCAAA,EAAqBxC,IAAI,CAACuC,GAA1B,CAJA;UAKLE,GAAG,EAAEzC,IAAI,CAACyC,GALL;UAMLC,QAAQ,EAAE1C,IAAI,CAACqD,SANV;UAOLV,QAAQ,EAAEmB;QAPL,CAAP;MASD;;IACD,KAAKd,6BAAA,CAAUiB,QAAf;MACE,OAAOjE,IAAI,CAACsD,aAAZ;;IACF,KAAKN,6BAAA,CAAUkB,kBAAf;IACA,KAAKlB,6BAAA,CAAUmB,QAAf;IACA,KAAKnB,6BAAA,CAAUoB,IAAf;IACA,KAAKpB,6BAAA,CAAUqB,eAAf;IACA,KAAKrB,6BAAA,CAAUsB,eAAf;MACE,OAAOpB,cAAc,CAAClD,IAAI,CAACmD,KAAN,CAArB;;IACF,KAAKH,6BAAA,CAAUuB,QAAf;IACA,KAAKvB,6BAAA,CAAUwB,aAAf;IACA,KAAKxB,6BAAA,CAAUyB,mBAAf;IACA,KAAKzB,6BAAA,CAAU0B,UAAf;MAA2B;QACzB,OAAO;UACLpC,QAAQ,EAAE,UADL;UAELvB,IAAI,EAAEf,IAAI,CAACe,IAFN;UAGLa,KAAK,oBAAO5B,IAAI,CAAC2E,YAAZ,CAHA;UAILpC,GAAG,EAAE,IAAAC,wCAAA,EAAqBxC,IAAI,CAACuC,GAA1B,CAJA;UAKLE,GAAG,EAAEzC,IAAI,CAACyC,GALL;UAMLC,QAAQ,EAAE,IANL;UAOLC,QAAQ,EAAEO,cAAc,CAAClD,IAAI,CAACmD,KAAN;QAPnB,CAAP;MASD;;IACD,KAAKH,6BAAA,CAAU4B,qBAAf;IACA,KAAK5B,6BAAA,CAAU6B,iBAAf;MAAkC;QAChC,IAAMlD,SAAQ,GAAGxB,OAAO,CAACN,oBAAoB,CAACG,IAAI,CAACmD,KAAL,CAAWA,KAAZ,CAApB,CAAuCY,GAAvC,CAA2CnB,OAA3C,CAAD,CAAxB;;QAEA,OAAO;UACLN,QAAQ,EAAE,UADL;UAELvB,IAAI,EAAE+D,iBAFD;UAGLlD,KAAK,oBAAO5B,IAAI,CAACsD,aAAZ,CAHA;UAILf,GAAG,EAAE,IAAAC,wCAAA,EAAqBxC,IAAI,CAACuC,GAA1B,CAJA;UAKLE,GAAG,EAAEzC,IAAI,CAACyC,GALL;UAMLC,QAAQ,EAAE,IANL;UAOLC,QAAQ,EAAEhB,SAAQ,CAACnB,MAAT,GAAkBmB,SAAlB,GAA6BuB,cAAc,CAAClD,IAAI,CAACmD,KAAN;QAPhD,CAAP;MASD;;IACD,KAAKH,6BAAA,CAAU+B,aAAf;MACE,OAAO7B,cAAc,CAAClD,IAAI,CAACmD,KAAN,CAArB;;IACF,KAAKH,6BAAA,CAAUgC,cAAf;IACA,KAAKhC,6BAAA,CAAUiC,kBAAf;IACA,KAAKjC,6BAAA,CAAUkC,qBAAf;IACA,KAAKlC,6BAAA,CAAUmC,cAAf;IACA,KAAKnC,6BAAA,CAAUoC,sBAAf;MACE,OAAOxC,OAAM,CAAC5C,IAAI,CAACmD,KAAN,CAAb;;IACF;MACE,MAAM,IAAIkC,KAAJ,wDAA0DrF,IAAI,CAAC+C,GAA/D,EAAN;EAvIJ;AAyID;;AAED,SAASG,cAAT,CAAwBlD,IAAxB,EAA8B;EAC5B,IAAI,CAACA,IAAL,EAAW;IACT,OAAO,IAAP;EACD;;EACD,IAAM2B,QAAQ,GAAG9B,oBAAoB,CAACG,IAAD,CAArC;;EACA,IAAI2B,QAAQ,CAACnB,MAAT,KAAoB,CAAxB,EAA2B;IACzB,OAAO,IAAP;EACD;;EACD,IAAImB,QAAQ,CAACnB,MAAT,KAAoB,CAAxB,EAA2B;IACzB,OAAOoC,OAAM,CAACjB,QAAQ,CAAC,CAAD,CAAT,CAAb;EACD;;EACD,OAAOxB,OAAO,CAACwB,QAAQ,CAACoC,GAAT,CAAanB,OAAb,CAAD,CAAd;AACD;;AAED,SAAS0C,eAAT,CAAwBC,KAAxB,EAA+B;EAC7B;EACA;EACA;EACA;EACA;EACA,IAAIvF,IAAI,GAAGuF,KAAX;;EACA,OAAOvF,IAAI,IAAI,CAACY,KAAK,CAACC,OAAN,CAAcb,IAAd,CAAT,IAAgCA,IAAI,CAAC0C,QAAL,KAAkB,IAAzD,EAA+D;IAC7D1C,IAAI,GAAGA,IAAI,CAAC2C,QAAZ;EACD,CAT4B,CAU7B;;;EACA,IAAI,CAAC3C,IAAL,EAAW;IACT,OAAO,IAAP;EACD;;EAED,IAAMwF,MAAM,GAAG,SAATA,MAAS,CAACC,IAAD,EAAU;IACvB,IAAIA,IAAI,IAAIA,IAAI,CAAC/C,QAAjB,EAA2B,OAAO,IAAAgD,qBAAA,EAAYD,IAAI,CAAC/C,QAAjB,CAAP;IAC3B,OAAO,IAAP;EACD,CAHD;;EAIA,IAAI9B,KAAK,CAACC,OAAN,CAAcb,IAAd,CAAJ,EAAyB;IACvB,OAAOA,IAAI,CAAC+D,GAAL,CAASyB,MAAT,CAAP;EACD;;EACD,IAAI5E,KAAK,CAACC,OAAN,CAAcb,IAAI,CAAC2C,QAAnB,KAAgC3C,IAAI,CAACsC,QAAL,KAAkB,OAAtD,EAA+D;IAC7D,OAAOtC,IAAI,CAAC2C,QAAL,CAAcoB,GAAd,CAAkByB,MAAlB,CAAP;EACD;;EACD,OAAOA,MAAM,CAACxF,IAAD,CAAb;AACD;;AAED,SAAS8B,uBAAT,CAAiC9B,IAAjC,EAAuC6B,QAAvC,EAAiD;EAC/C,IAAI,CAAC7B,IAAL,EAAW;IACT,OAAO,IAAP;EACD;;EACD,IAAIY,KAAK,CAACC,OAAN,CAAcb,IAAd,CAAJ,EAAyB;IACvB,OAAOA,IAAI,CAAC+D,GAAL,CAAS,UAACpD,EAAD;MAAA,OAAQmB,uBAAuB,CAACnB,EAAD,EAAKkB,QAAL,CAA/B;IAAA,CAAT,CAAP;EACD;;EACD,IAAIR,MAAM,CAACrB,IAAI,CAACe,IAAN,CAAV,EAAuB;IACrB;IACA,OAAOc,QAAP;EACD;;EACD,uCACK7B,IADL;IAEE4B,KAAK,kCACA5B,IAAI,CAAC4B,KADL;MAEHD,QAAQ,EAAEG,uBAAuB,CAAC9B,IAAI,CAAC4B,KAAL,CAAWD,QAAZ,EAAsBE,QAAtB;IAF9B;EAFP;AAOD;;AAED,SAAS8D,kBAAT,GAA8B;EAC5B;EACA;EACA;EAH4B,IAKtBC,UALsB;IAAA;;IAAA;;IAAA;MAAA;;MAAA;IAAA;;IAAA;MAAA;MAAA,OAM1B,kBAAS;QACP,OAAO,IAAP;MACD;IARyB;;IAAA;EAAA,EAKH5D,iBAAA,CAAM6D,SALH;;EAU5B,IAAMC,YAAY,GAAG,IAAIC,mBAAJ,EAArB;EACAD,YAAY,CAACE,MAAb,eAAoBhE,iBAAA,CAAMC,aAAN,CAAoB2D,UAApB,CAApB;EACA,OAAOE,YAAY,CAACG,SAAb,CAAuBC,KAA9B;AACD;;AAED,SAASC,OAAT,CAAiBC,EAAjB,EAAqB;EACnB,IAAIC,SAAJ;;EACAC,qBAAA,CAAUC,GAAV,CAAc,YAAM;IAClBF,SAAS,GAAGD,EAAE,EAAd;EACD,CAFD;;EAGA,OAAOC,SAAP;AACD;;AAED,SAASG,uBAAT,CAAiCC,QAAjC,EAA2C;EACzC;EACA,IAAI,mBAAmBA,QAAQ,CAACC,QAAhC,EAA0C;IACxC,OAAOD,QAAQ,CAACC,QAAT,CAAkBC,aAAzB;EACD;;EACD,IAAI,mBAAmBF,QAAQ,CAACC,QAAhC,EAA0C;IACxC,OAAOD,QAAQ,CAACC,QAAT,CAAkBE,aAAzB;EACD;;EACD,MAAM,IAAIvB,KAAJ,CAAU,6EAAV,CAAN;AACD;;AAED,SAASwB,eAAT,CAAyB9F,IAAzB,EAA+B;EAC7B,OAAO;IAAE+F,QAAQ,EAAEC,gBAAZ;IAAqBhG,IAAI,EAAJA;EAArB,CAAP;AACD;;AAED,SAASiG,UAAT,CAAoBnB,SAApB,EAA+B;EAC7B,OACEA,SAAS,CAACoB,SAAV,KACCpB,SAAS,CAACoB,SAAV,CAAoBC,gBAApB,IAAwCtG,KAAK,CAACC,OAAN,CAAcgF,SAAS,CAACsB,oBAAxB,CADzC,CADF,CAE0F;EAF1F;AAID;;IAEKC,oB;;;;;EACJ,gCAAc;IAAA;;IAAA;;IACZ,2BADY,CAGZ;;IACA,4BAA+BC,oBAAA,CAAaJ,SAA5C;IAAA,IAAQK,QAAR,yBAAQA,QAAR;IAAA,IAAkBC,QAAlB,yBAAkBA,QAAlB;;IACAF,oBAAA,CAAaJ,SAAb,CAAuBK,QAAvB,GAAkC,YAAmB;MAAA;;MAAA,kCAANE,IAAM;QAANA,IAAM;MAAA;;MACnD,OAAOrB,OAAO,CAAC;QAAA,OAAMmB,QAAQ,CAACG,KAAT,CAAe,MAAf,EAAqBD,IAArB,CAAN;MAAA,CAAD,CAAd;IACD,CAFD;;IAGAH,oBAAA,CAAaJ,SAAb,CAAuBM,QAAvB,GAAkC,YAAmB;MAAA;;MAAA,mCAANC,IAAM;QAANA,IAAM;MAAA;;MACnD,OAAOrB,OAAO,CAAC;QAAA,OAAMoB,QAAQ,CAACE,KAAT,CAAe,MAAf,EAAqBD,IAArB,CAAN;MAAA,CAAD,CAAd;IACD,CAFD;;IAIA,IAAQE,UAAR,GAAuB,MAAKC,OAA5B,CAAQD,UAAR;IACA,MAAKC,OAAL,mCACK,MAAKA,OADV;MAEEC,kCAAkC,EAAE,IAFtC;MAE4C;MAC1CC,iBAAiB,EAAE,QAHrB;MAIEH,UAAU,kCACLA,UADK;QAERI,kBAAkB,EAAE;UAClBC,UAAU,EAAE;QADM,CAFZ;QAKRC,wBAAwB,EAAE;UACxBC,2BAA2B,EAAE;QADL,CALlB;QAQRC,uBAAuB,EAAE,IARjB;QASRX,QAAQ,EAAE;UACRY,gCAAgC,EAAE;QAD1B,CATF;QAYRC,eAAe,EAAE;UACfC,gBAAgB,EAAE;QADH,CAZT;QAeRC,wBAAwB,EAAE;MAflB;IAJZ;IAbY;EAmCb;;;;WAED,6BAAoBX,OAApB,EAA6B;MAC3B,IAAAY,sCAAA,EAAmB,OAAnB;;MACA,IAAI,IAAAC,eAAA,EAAIb,OAAJ,EAAa,kBAAb,CAAJ,EAAsC;QACpC,MAAM,IAAIc,SAAJ,CAAc,6DAAd,CAAN;MACD;;MAED,IAAQC,QAAR,GAAwDf,OAAxD,CAAQe,QAAR;MAAA,IAAkBC,SAAlB,GAAwDhB,OAAxD,CAAkBgB,SAAlB;MAAA,IAA6BC,sBAA7B,GAAwDjB,OAAxD,CAA6BiB,sBAA7B;MACA,IAAMC,OAAO,GAAGF,SAAS,IAAID,QAAb,IAAyBI,MAAM,CAACC,QAAP,CAAgB9G,aAAhB,CAA8B,KAA9B,CAAzC;MACA,IAAIS,QAAQ,GAAG,IAAf;MACA,IAAMsG,OAAO,GAAG,IAAhB;MAEA,IAAIC,IAAJ;MAEA,OAAO;QACLjD,MADK,kBACErF,EADF,EACMuI,OADN,EACeC,QADf,EACyB;UAC5B,OAAOhD,OAAO,CAAC,YAAM;YACnB,IAAIzD,QAAQ,KAAK,IAAjB,EAAuB;cACrB,IAAQ3B,IAAR,GAA6BJ,EAA7B,CAAQI,IAAR;cAAA,IAAca,KAAd,GAA6BjB,EAA7B,CAAciB,KAAd;cAAA,IAAqBa,GAArB,GAA6B9B,EAA7B,CAAqB8B,GAArB;;cACA,IAAM2G,YAAY;gBAChBvD,SAAS,EAAE9E,IADK;gBAEhBa,KAAK,EAALA,KAFgB;gBAGhBgH,sBAAsB,EAAtBA,sBAHgB;gBAIhBM,OAAO,EAAPA;cAJgB,GAKZzG,GAAG,IAAI;gBAAE4G,OAAO,EAAE5G;cAAX,CALK,CAAlB;;cAQA,IAAI6G,SAAJ;cAEA,IAAMC,qBAAqB,GAAG,IAAAC,sCAAA,EAAmB7I,EAAnB,kCAA4BgH,OAA5B;gBAAqCqB,OAAO,EAAPA;cAArC,GAA9B;cACAM,SAAS,gBAAGtH,iBAAA,CAAMC,aAAN,CAAoBsH,qBAApB,EAA2CH,YAA3C,CAAZ;cACAH,IAAI,GAAGN,SAAS,GAAG,IAAAc,mBAAA,EAAYZ,OAAZ,EAAqBS,SAArB,CAAH,GAAqC,IAAAI,kBAAA,EAAWb,OAAX,CAArD;cAEA,IAAAc,mBAAA,EAAU,YAAM;gBACdV,IAAI,CAACjD,MAAL,CAAYsD,SAAZ;cACD,CAFD;cAIA5G,QAAQ,GAAG,IAAAkH,yCAAA,EAAsBX,IAAtB,CAAX;;cAEA,IAAI,OAAOE,QAAP,KAAoB,UAAxB,EAAoC;gBAClCA,QAAQ;cACT;YACF,CAzBD,MAyBO;cACLzG,QAAQ,CAACmH,aAAT,CAAuBlJ,EAAE,CAACiB,KAA1B,EAAiCsH,OAAjC,EAA0CC,QAA1C;YACD;UACF,CA7Ba,CAAd;QA8BD,CAhCI;QAiCLW,OAjCK,qBAiCK;UACR3D,OAAO,CAAC,YAAM;YAAA;;YACZ,SAAA8C,IAAI,UAAJ,sCAAMa,OAAN;UACD,CAFM,CAAP;UAGApH,QAAQ,GAAG,IAAX;QACD,CAtCI;QAuCLqH,OAvCK,qBAuCK;UACR,IAAI,CAACrH,QAAL,EAAe;YACb,OAAO,IAAP;UACD;;UACD,OAAO,IAAAsH,yCAAA,EACLhB,OAAO,CAACiB,iBADH,EAELrH,OAAM,CAACF,QAAQ,CAACwH,eAAV,CAFD,EAGLvC,OAHK,CAAP;QAKD,CAhDI;QAiDLwC,aAjDK,yBAiDSC,aAjDT,EAiDwBC,QAjDxB,EAiDkCC,KAjDlC,EAiDyC;UAC5C,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,QAAoC;YAAA,IAAvBC,UAAuB,SAAjC9H,QAAiC;YAAA,IAAX3B,IAAW,SAAXA,IAAW;;YAC1D,IAAIA,IAAI,IAAIA,IAAI,CAACuH,wBAAjB,EAA2C;cACzC,OAAO,IAAP;YACD;;YACD,OAAOkC,UAAU,IAAIA,UAAU,CAACC,iBAAhC;UACD,CALD;;UAOA,YACEL,aAAa,CAACM,IAAd,CAAmBH,eAAnB,KAAuC,EADzC;UAAA,IAAkBI,gBAAlB,SAAQjI,QAAR;UAAA,IAA0CkI,YAA1C,SAAoC7J,IAApC;;UAGAuF,qBAAA,CAAUC,GAAV,CAAc,YAAM;YAClB,IAAA4D,iCAAA,EACEG,KADF,EAEEK,gBAFF,EAGEN,QAHF,EAIED,aAJF,EAKEtJ,gBALF,EAMEkI,OAAO,CAAC6B,iBANV,EAOED,YAPF;UASD,CAVD;QAWD,CAvEI;QAwELE,aAxEK,yBAwES9K,IAxET,EAwEe+K,KAxEf,EAwEsBC,IAxEtB,EAwE4B;UAC/B,IAAMC,WAAW,GAAG,IAAAC,uCAAA,EAAoBH,KAApB,CAApB;UACA,IAAMI,OAAO,GAAG7E,qBAAA,CAAU8E,QAAV,CAAmBH,WAAnB,CAAhB;;UACA,IAAI,CAACE,OAAL,EAAc;YACZ,MAAM,IAAI1C,SAAJ,2CAAiDsC,KAAjD,sBAAN;UACD;;UACD5E,OAAO,CAAC,YAAM;YACZgF,OAAO,CAACnC,OAAO,CAAC1D,cAAR,CAAuBtF,IAAvB,CAAD,EAA+BgL,IAA/B,CAAP;UACD,CAFM,CAAP;QAGD,CAjFI;QAkFLK,cAlFK,0BAkFUjF,EAlFV,EAkFc;UACjB,OAAOA,EAAE,EAAT;QACD,CApFI;QAqFLkF,4BArFK,0CAqF0B;UAC7B,uCACK,IADL,GAEK,IAAAC,qDAAA,EAAkC;YACnC3I,MAAM,EAAE,gBAAC4I,IAAD;cAAA,OAAU5I,OAAM,CAAC4I,IAAI,CAACtB,eAAN,CAAhB;YAAA,CAD2B;YAEnCuB,uBAAuB,EAAE;cAAA,OAAM/I,QAAN;YAAA;UAFU,CAAlC,CAFL;QAOD,CA7FI;QA8FLgJ,UAAU,EAAEvF;MA9FP,CAAP;IAgGD;;;WAED,iCAAoC;MAAA;;MAAA,IAAdwB,OAAc,uEAAJ,EAAI;MAClC,IAAMqB,OAAO,GAAG,IAAhB;MACA,IAAM2C,QAAQ,GAAG,IAAI5F,mBAAJ,EAAjB;MACA,IAAQtE,gBAAR,GAA6BkG,OAA7B,CAAQlG,gBAAR;;MACA,IAAI,OAAOA,gBAAP,KAA4B,WAA5B,IAA2C,OAAOA,gBAAP,KAA4B,SAA3E,EAAsF;QACpF,MAAMgH,SAAS,CAAC,2DAAD,CAAf;MACD;;MACD,IAAImD,KAAK,GAAG,KAAZ;MACA,IAAIC,UAAU,GAAG,IAAjB;MAEA,IAAIC,aAAa,GAAG,IAApB;MACA,IAAIC,gBAAgB,GAAG,IAAvB;MACA,IAAMC,QAAQ,GAAG,EAAjB,CAZkC,CAclC;;MACA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACpG,SAAD,EAAYqG,OAAZ,EAAwB;QAChD,IAAIJ,aAAa,KAAKjG,SAAtB,EAAiC;UAC/B,IAAImB,UAAU,CAACnB,SAAD,CAAd,EAA2B;YACzBkG,gBAAgB;cAAA;;cAAA;;cAAA;gBAAA;;gBAAA;cAAA;;cAAA;YAAA,EAAiBlG,SAAjB,CAAhB;;YACA,IAAIqG,OAAJ,EAAa;cACXH,gBAAgB,CAAC9E,SAAjB,CAA2BkF,qBAA3B,GAAmD,UAACC,SAAD;gBAAA,OACjD,CAACF,OAAO,CAAC,MAAI,CAACtK,KAAN,EAAawK,SAAb,CADyC;cAAA,CAAnD;YAED,CAHD,MAGO;cACLL,gBAAgB,CAAC9E,SAAjB,CAA2BoF,oBAA3B,GAAkD,IAAlD;YACD;UACF,CARD,MAQO;YACL,IAAIC,QAAQ,GAAGN,QAAf;YACA,IAAIO,SAAJ;;YACAR,gBAAgB,GAAG,SAASS,kBAAT,CAA4B5K,KAA5B,EAA4C;cAC7D,IAAM6K,YAAY,GAChBH,QAAQ,KAAKN,QAAb,KACCE,OAAO,GAAG,CAACA,OAAO,CAACK,SAAD,EAAY3K,KAAZ,CAAX,GAAgC,CAAC,IAAA8K,8BAAA,EAAaH,SAAb,EAAwB3K,KAAxB,CADzC,CADF;;cAGA,IAAI6K,YAAJ,EAAkB;gBAAA,mCAJqCjF,IAIrC;kBAJqCA,IAIrC;gBAAA;;gBAChB8E,QAAQ,GAAGzG,SAAS,MAAT,0CAAeA,SAAS,CAAC8G,YAAzB,GAA0C/K,KAA1C,UAAsD4F,IAAtD,EAAX;gBACA+E,SAAS,GAAG3K,KAAZ;cACD;;cACD,OAAO0K,QAAP;YACD,CATD;UAUD;;UACDM,MAAM,CAACC,MAAP,CAAcd,gBAAd,EAAgClG,SAAhC,EAA2C;YACzCiH,WAAW,EAAE9D,OAAO,CAAC6B,iBAAR,CAA0B;cAAE9J,IAAI,EAAE8E;YAAR,CAA1B;UAD4B,CAA3C;UAGAiG,aAAa,GAAGjG,SAAhB;QACD;;QACD,OAAOkG,gBAAP;MACD,CA9BD,CAfkC,CA+ClC;MACA;;;MACA,IAAMgB,uBAAuB,GAAG,SAA1BA,uBAA0B,CAAClH,SAAD,EAAe;QAC7C,IAAI,IAAA2C,eAAA,EAAI3C,SAAJ,EAAe,cAAf,CAAJ,EAAoC;UAClC,IAAIiG,aAAa,KAAKjG,SAAtB,EAAiC;YAC/BkG,gBAAgB,GAAGa,MAAM,CAACC,MAAP,CACjB,UAACjL,KAAD;cAAA,mCAAW4F,IAAX;gBAAWA,IAAX;cAAA;;cAAA,OAAoB3B,SAAS,MAAT,0CAAeA,SAAS,CAAC8G,YAAzB,GAA0C/K,KAA1C,UAAsD4F,IAAtD,EAApB;YAAA,CADiB,EAEjB3B,SAFiB,EAGjB;cAAEiH,WAAW,EAAE9D,OAAO,CAAC6B,iBAAR,CAA0B;gBAAE9J,IAAI,EAAE8E;cAAR,CAA1B;YAAf,CAHiB,CAAnB;YAKAiG,aAAa,GAAGjG,SAAhB;UACD;;UACD,OAAOkG,gBAAP;QACD;;QAED,OAAOlG,SAAP;MACD,CAdD;;MAgBA,IAAMmH,aAAa,GAAG,SAAhBA,aAAgB,CAACC,QAAD,EAAuB;QAAA,mCAATC,IAAS;UAATA,IAAS;QAAA;;QAC3C;QACA,IAAMC,UAAU,GAAGxB,QAAQ,CAAC3F,MAAT,OAAA2F,QAAQ,GAAQsB,QAAR,SAAqBC,IAArB,EAA3B;QAEA,IAAME,aAAa,GAAG,CAAC,EAAED,UAAU,IAAIA,UAAU,CAACpM,IAA3B,CAAvB;;QACA,IAAIqM,aAAJ,EAAmB;UACjB,IAAMC,QAAQ,GAAG7L,8BAA8B,CAAC2L,UAAD,EAAa;YAAE1L,gBAAgB,EAAhBA;UAAF,CAAb,CAA/C;UAEA,IAAM6L,gBAAgB,GAAGD,QAAQ,CAACtM,IAAT,KAAkBoM,UAAU,CAACpM,IAAtD;;UACA,IAAIuM,gBAAJ,EAAsB;YACpB,OAAO3B,QAAQ,CAAC3F,MAAT,OAAA2F,QAAQ,mCAAasB,QAAb;cAAuBlM,IAAI,EAAEsM,QAAQ,CAACtM;YAAtC,WAAiDmM,IAAjD,EAAf;UACD;QACF;;QAED,OAAOC,UAAP;MACD,CAfD;;MAiBA,OAAO;QACLnH,MADK,kBACErF,EADF,EACM4M,eADN,EAC4D;UAAA,gFAAJ,EAAI;UAAA,iCAAnCC,cAAmC;UAAA,IAAnCA,cAAmC,qCAAlB,IAAIC,GAAJ,EAAkB;;UAC/D5B,UAAU,GAAGlL,EAAb;;UACA,IAAI,OAAOA,EAAE,CAACI,IAAV,KAAmB,QAAvB,EAAiC;YAC/B6K,KAAK,GAAG,IAAR;UACD,CAFD,MAEO,IAAI,IAAA8B,0BAAA,EAAkB/M,EAAlB,CAAJ,EAA2B;YAChC6M,cAAc,CAACG,GAAf,CAAmBhN,EAAE,CAACI,IAAtB,EAA4BJ,EAAE,CAACiB,KAAH,CAASgM,KAArC;YACA,IAAMC,YAAY,GAAGjB,MAAM,CAACC,MAAP,CAAc,UAACjL,KAAD;cAAA,OAAWA,KAAK,CAACD,QAAjB;YAAA,CAAd,EAAyChB,EAAE,CAACI,IAA5C,CAArB;YACA,OAAO,IAAA+M,uCAAA,EAAoB;cAAA,OAAMd,aAAa,iCAAMrM,EAAN;gBAAUI,IAAI,EAAE8M;cAAhB,GAAnB;YAAA,CAApB,CAAP;UACD,CAJM,MAIA,IAAI,IAAAE,0BAAA,EAAkBpN,EAAlB,CAAJ,EAA2B;YAChC,IAAM8F,QAAQ,GAAGuC,OAAO,CAACgF,uBAAR,CAAgCrN,EAAE,CAACI,IAAnC,CAAjB;YACA,IAAM6M,KAAK,GAAGJ,cAAc,CAAChF,GAAf,CAAmB/B,QAAnB,IACV+G,cAAc,CAACS,GAAf,CAAmBxH,QAAnB,CADU,GAEVD,uBAAuB,CAACC,QAAD,CAF3B;YAGA,IAAMyH,YAAY,GAAGtB,MAAM,CAACC,MAAP,CAAc,UAACjL,KAAD;cAAA,OAAWA,KAAK,CAACD,QAAN,CAAeiM,KAAf,CAAX;YAAA,CAAd,EAAgDjN,EAAE,CAACI,IAAnD,CAArB;YACA,OAAO,IAAA+M,uCAAA,EAAoB;cAAA,OAAMd,aAAa,iCAAMrM,EAAN;gBAAUI,IAAI,EAAEmN;cAAhB,GAAnB;YAAA,CAApB,CAAP;UACD,CAPM,MAOA;YACLtC,KAAK,GAAG,KAAR;YACA,IAAIuB,UAAU,GAAGxM,EAAjB;;YACA,IAAIU,MAAM,CAAC8L,UAAD,CAAV,EAAwB;cACtB,MAAM1E,SAAS,CAAC,qDAAD,CAAf;YACD;;YAED0E,UAAU,GAAG3L,8BAA8B,CAAC2L,UAAD,EAAa;cAAE1L,gBAAgB,EAAhBA;YAAF,CAAb,CAA3C;YACA,kBAA4B0L,UAA5B;YAAA,IAActH,SAAd,eAAQ9E,IAAR;YAEA,IAAMmI,OAAO,GAAG,IAAAiF,oCAAA,EAAiBtI,SAAS,CAACuI,YAA3B,EAAyCb,eAAzC,CAAhB;;YAEA,IAAIrM,MAAM,CAACP,EAAE,CAACI,IAAJ,CAAV,EAAqB;cACnB,eAAqCJ,EAAE,CAACI,IAAxC;cAAA,IAAcsN,SAAd,YAAQtN,IAAR;cAAA,IAAyBmL,OAAzB,YAAyBA,OAAzB;cAEA,OAAO,IAAA4B,uCAAA,EAAoB;gBAAA,OACzBd,aAAa,iCAAMrM,EAAN;kBAAUI,IAAI,EAAEkL,iBAAiB,CAACoC,SAAD,EAAYnC,OAAZ;gBAAjC,IAAyDhD,OAAzD,CADY;cAAA,CAApB,CAAP;YAGD;;YAED,IAAMoF,mBAAmB,GAAGtH,UAAU,CAACnB,SAAD,CAAtC;;YAEA,IAAI,CAACyI,mBAAD,IAAwB,OAAOzI,SAAP,KAAqB,UAAjD,EAA6D;cAC3D,OAAO,IAAAiI,uCAAA,EAAoB;gBAAA,OACzBd,aAAa,iCAAMG,UAAN;kBAAkBpM,IAAI,EAAEgM,uBAAuB,CAAClH,SAAD;gBAA/C,IAA8DqD,OAA9D,CADY;cAAA,CAApB,CAAP;YAGD;;YAED,IAAIoF,mBAAJ,EAAyB;cACvB,IACE3C,QAAQ,CAAC1F,SAAT,IACAtF,EAAE,CAACiB,KAAH,KAAa+J,QAAQ,CAAC1F,SAAT,CAAmBrE,KADhC,IAEA,CAAC,IAAA8K,8BAAA,EAAaxD,OAAb,EAAsByC,QAAQ,CAAC1F,SAAT,CAAmBiD,OAAzC,CAHH,EAIE;gBACA,iBAAoB,IAAAqF,6BAAA,EAClB5C,QADkB,EAElB,uBAFkB,EAGlB,UAAC6C,cAAD;kBAAA,OACE,SAASC,qBAAT,GAAwC;oBACtC,IAAQ7M,KAAR,GAAkB+J,QAAQ,CAAC1F,SAA3B,CAAQrE,KAAR;;oBACA,IAAM8M,WAAW,qBAAQ9M,KAAR,CAAjB;;oBACA+J,QAAQ,CAAC1F,SAAT,CAAmBrE,KAAnB,GAA2B8M,WAA3B;;oBAHsC,mCAANlH,IAAM;sBAANA,IAAM;oBAAA;;oBAKtC,IAAMnH,MAAM,GAAGmO,cAAc,CAAC/G,KAAf,CAAqBkE,QAArB,EAA+BnE,IAA/B,CAAf;oBAEAmE,QAAQ,CAAC1F,SAAT,CAAmBrE,KAAnB,GAA2BA,KAA3B;oBACA+M,OAAO;oBAEP,OAAOtO,MAAP;kBACD,CAZH;gBAAA,CAHkB,CAApB;gBAAA,IAAQsO,OAAR,cAAQA,OAAR;cAiBD,CAvBsB,CAyBvB;;;cACA,IAAMC,eAAe,GAAGjJ,kBAAkB,EAA1C;;cACA,IAAIiJ,eAAJ,EAAqB;gBACnBhC,MAAM,CAACiC,cAAP,CAAsBhJ,SAAS,CAACoB,SAAhC,EAA2C,OAA3C,EAAoD;kBAClD6H,YAAY,EAAE,IADoC;kBAElDC,UAAU,EAAE,IAFsC;kBAGlDd,GAHkD,iBAG5C;oBACJ,OAAO,IAAP;kBACD,CALiD;kBAMlDN,GANkD,eAM9CC,KAN8C,EAMvC;oBACT,IAAIA,KAAK,KAAKgB,eAAd,EAA+B;sBAC7BhC,MAAM,CAACiC,cAAP,CAAsB,IAAtB,EAA4B,OAA5B,EAAqC;wBACnCC,YAAY,EAAE,IADqB;wBAEnCC,UAAU,EAAE,IAFuB;wBAGnCnB,KAAK,EAALA,KAHmC;wBAInCoB,QAAQ,EAAE;sBAJyB,CAArC;oBAMD;kBACF;gBAfiD,CAApD;cAiBD;YACF;;YACD,OAAO,IAAAlB,uCAAA,EAAoB;cAAA,OAAMd,aAAa,CAACG,UAAD,EAAajE,OAAb,CAAnB;YAAA,CAApB,CAAP;UACD;QACF,CA7FI;QA8FLY,OA9FK,qBA8FK;UACR6B,QAAQ,CAAC7B,OAAT;QACD,CAhGI;QAiGLC,OAjGK,qBAiGK;UACR,IAAI6B,KAAJ,EAAW;YACT,OAAO1J,aAAa,CAAC2J,UAAD,CAApB;UACD;;UACD,IAAMoD,MAAM,GAAGtD,QAAQ,CAACuD,eAAT,EAAf;UACA,OAAO;YACL5M,QAAQ,EAAExB,gBAAgB,CAAC+K,UAAU,CAAC9K,IAAZ,CADrB;YAELA,IAAI,EAAE8K,UAAU,CAAC9K,IAFZ;YAGLa,KAAK,EAAEiK,UAAU,CAACjK,KAHb;YAILW,GAAG,EAAE,IAAAC,wCAAA,EAAqBqJ,UAAU,CAACtJ,GAAhC,CAJA;YAKLE,GAAG,EAAEoJ,UAAU,CAACpJ,GALX;YAMLC,QAAQ,EAAEiJ,QAAQ,CAAC1F,SANd;YAOLtD,QAAQ,EAAE/B,KAAK,CAACC,OAAN,CAAcoO,MAAd,IACN9O,OAAO,CAAC8O,MAAD,CAAP,CAAgBlL,GAAhB,CAAoB,UAACpD,EAAD;cAAA,OAAQuB,aAAa,CAACvB,EAAD,CAArB;YAAA,CAApB,CADM,GAENuB,aAAa,CAAC+M,MAAD;UATZ,CAAP;QAWD,CAjHI;QAkHL9E,aAlHK,yBAkHSC,aAlHT,EAkHwBC,QAlHxB,EAkHkCC,KAlHlC,EAkHyC;UAC5C,IAAAH,iCAAA,EACEG,KADF,EAEEqB,QAAQ,CAAC1F,SAFX,EAGE4F,UAHF,EAIEzB,aAAa,CAAC+E,MAAd,CAAqBtD,UAArB,CAJF,EAKE/K,gBALF,EAMEkI,OAAO,CAAC6B,iBANV,EAOEgB,UAAU,CAAC9K,IAPb;QASD,CA5HI;QA6HL+J,aA7HK,yBA6HS9K,IA7HT,EA6He+K,KA7Hf,EA6H+B;UAAA,mCAANvD,IAAM;YAANA,IAAM;UAAA;;UAClC,IAAM4H,OAAO,GAAGpP,IAAI,CAAC4B,KAAL,CAAW,IAAAyN,iCAAA,EAActE,KAAd,CAAX,CAAhB;;UACA,IAAIqE,OAAJ,EAAa;YACX,IAAAtB,uCAAA,EAAoB,YAAM;cACxB;cACA;cACAsB,OAAO,MAAP,SAAW5H,IAAX;YACD,CAJD;UAKD;QACF,CAtII;QAuIL6D,cAvIK,0BAuIUjF,EAvIV,EAuIc;UACjB,OAAOA,EAAE,EAAT;QACD,CAzII;QA0ILkJ,cA1IK,0BA0IUC,SA1IV,EA0IqBC,MA1IrB,EA0I6BC,QA1I7B,EA0IuCC,SA1IvC,EA0IkD;UACrD,OAAO,IAAAJ,2BAAA,EAAeC,SAAf,EAA0BC,MAA1B,EAAkCC,QAAlC,EAA4C,IAAA5E,qCAAA,EAAkBgB,UAAlB,CAA5C,EAA2E;YAAA,OAChF,IAAA8D,qCAAA,EAAkBD,SAAS,CAACP,MAAV,CAAiB,CAACtD,UAAD,CAAjB,CAAlB,CADgF;UAAA,CAA3E,CAAP;QAGD;MA9II,CAAP;IAgJD;;;WAED,8BAAqBlE,OAArB,EAA8B;MAC5B,IAAI,IAAAa,eAAA,EAAIb,OAAJ,EAAa,kBAAb,CAAJ,EAAsC;QACpC,MAAM,IAAIc,SAAJ,CACJ,0EADI,CAAN;MAGD;;MACD,OAAO;QACLzC,MADK,kBACErF,EADF,EACMuI,OADN,EACe;UAClB,IAAIvB,OAAO,CAACuB,OAAR,KAAoBvI,EAAE,CAACI,IAAH,CAAQqN,YAAR,IAAwBzG,OAAO,CAACiI,iBAApD,CAAJ,EAA4E;YAC1E,IAAMA,iBAAiB,mCACjBjP,EAAE,CAACI,IAAH,CAAQqN,YAAR,IAAwB,EADP,GAElBzG,OAAO,CAACiI,iBAFU,CAAvB;;YAIA,IAAMC,cAAc,GAAG,IAAAC,uCAAA,EAAoBnP,EAApB,EAAwBuI,OAAxB,EAAiC0G,iBAAjC,CAAvB;YACA,OAAOG,kBAAA,CAAeC,oBAAf,eAAoChO,iBAAA,CAAMC,aAAN,CAAoB4N,cAApB,CAApC,CAAP;UACD;;UACD,OAAOE,kBAAA,CAAeC,oBAAf,CAAoCrP,EAApC,CAAP;QACD;MAXI,CAAP;IAaD,C,CAED;IACA;;;;WACA,wBAAegH,OAAf,EAAwB;MACtB,QAAQA,OAAO,CAACsI,IAAhB;QACE,KAAKC,qBAAA,CAAcC,KAAd,CAAoBC,KAAzB;UACE,OAAO,KAAKC,mBAAL,CAAyB1I,OAAzB,CAAP;;QACF,KAAKuI,qBAAA,CAAcC,KAAd,CAAoBG,OAAzB;UACE,OAAO,KAAKC,qBAAL,CAA2B5I,OAA3B,CAAP;;QACF,KAAKuI,qBAAA,CAAcC,KAAd,CAAoBK,MAAzB;UACE,OAAO,KAAKC,oBAAL,CAA0B9I,OAA1B,CAAP;;QACF;UACE,MAAM,IAAItC,KAAJ,qDAAuDsC,OAAO,CAACsI,IAA/D,EAAN;MARJ;IAUD;;;WAED,cAAKS,OAAL,EAAc;MACZ,OAAO,IAAAC,wBAAA,EAAKD,OAAL,CAAP;IACD,C,CAED;IACA;IACA;;;;WACA,uBAAc1Q,IAAd,EAAoB;MAClB,IAAI,CAACA,IAAD,IAAS,QAAOA,IAAP,MAAgB,QAA7B,EAAuC,OAAO,IAAP;MACvC,IAAQe,IAAR,GAAiBf,IAAjB,CAAQe,IAAR;MACA,oBAAOiB,iBAAA,CAAMC,aAAN,CAAoBV,UAAU,CAACR,IAAD,CAA9B,EAAsC,IAAA6P,uCAAA,EAAoB5Q,IAApB,CAAtC,CAAP;IACD;;;WAED,4BAAmBA,IAAnB,EAAyB6Q,YAAzB,EAAuC;MACrC,IAAI,CAAC7Q,IAAL,EAAW;QACT,OAAOA,IAAP;MACD;;MACD,IAAQe,IAAR,GAAiBf,IAAjB,CAAQe,IAAR;MACA,OAAOQ,UAAU,CAACR,IAAD,CAAV,KAAqBQ,UAAU,CAACsP,YAAD,CAAtC;IACD;;;WAED,uBAAcH,OAAd,EAAuB;MACrB,OAAOxO,aAAa,CAACwO,OAAD,CAApB;IACD;;;WAED,wBAAe1Q,IAAf,EAA4C;MAAA,IAAvB8Q,aAAuB,uEAAP,KAAO;;MAC1C,IAAMC,KAAK,GAAGzL,eAAc,CAACtF,IAAD,CAA5B;;MACA,IAAIY,KAAK,CAACC,OAAN,CAAckQ,KAAd,KAAwB,CAACD,aAA7B,EAA4C;QAC1C;QACA,OAAOC,KAAK,CAACC,MAAN,CAAaC,OAAb,EAAsB,CAAtB,CAAP;MACD;;MACD,OAAOF,KAAP;IACD;;;WAED,2BAAkB/Q,IAAlB,EAAwB;MACtB,IAAI,CAACA,IAAL,EAAW,OAAO,IAAP;MACX,IAAQe,IAAR,GAA2Bf,IAA3B,CAAQe,IAAR;MAAA,IAAc+F,QAAd,GAA2B9G,IAA3B,CAAc8G,QAAd;MACA,IAAMkC,OAAO,GAAG,IAAhB;MAEA,IAAM1G,QAAQ,GAAGvB,IAAI,IAAI+F,QAAzB,CALsB,CAOtB;;MACA,IAAIxE,QAAJ,EAAc;QACZ,QAAQA,QAAR;UACE,KAAK4O,uBAAA,IAAkBC,GAAvB;YACE,OAAO,gBAAP;;UACF,KAAKhN,iBAAA,IAAYgN,GAAjB;YACE,OAAO,UAAP;;UACF,KAAKC,mBAAA,IAAcD,GAAnB;YACE,OAAO,YAAP;;UACF,KAAK5M,iBAAA,IAAY4M,GAAjB;YACE,OAAO,UAAP;;UACF,KAAKnQ,eAAA,IAAUmQ,GAAf;YACE,OAAO,QAAP;;UACF,KAAKrM,iBAAA,IAAYqM,GAAjB;YACE,OAAO,UAAP;;UACF;QAbF;MAeD;;MAED,IAAME,YAAY,GAAGtQ,IAAI,IAAIA,IAAI,CAAC+F,QAAlC;;MAEA,QAAQuK,YAAR;QACE,KAAK/M,wBAAA,IAAmB6M,GAAxB;UACE,OAAO,iBAAP;;QACF,KAAK9M,wBAAA,IAAmB8M,GAAxB;UACE,OAAO,iBAAP;;QACF,KAAK/P,aAAA,IAAQ+P,GAAb;UAAkB;YAChB,IAAMG,QAAQ,GAAG,IAAAzG,qCAAA,EAAkB7K,IAAlB,CAAjB;YACA,OAAO,OAAOsR,QAAP,KAAoB,QAApB,GAA+BA,QAA/B,kBAAkDtI,OAAO,CAAC6B,iBAAR,CAA0B9J,IAA1B,CAAlD,MAAP;UACD;;QACD,KAAK2D,mBAAA,IAAcyM,GAAnB;UAAwB;YACtB,IAAIpQ,IAAI,CAAC+L,WAAT,EAAsB;cACpB,OAAO/L,IAAI,CAAC+L,WAAZ;YACD;;YACD,IAAMyE,IAAI,GAAGvI,OAAO,CAAC6B,iBAAR,CAA0B;cAAE9J,IAAI,EAAEA,IAAI,CAACiF;YAAb,CAA1B,CAAb;YACA,OAAOuL,IAAI,wBAAiBA,IAAjB,SAA2B,YAAtC;UACD;;QACD,KAAKjQ,aAAA,IAAQ6P,GAAb;UAAkB;YAChB,OAAO,MAAP;UACD;;QACD;UACE,OAAO,IAAAtG,qCAAA,EAAkB7K,IAAlB,CAAP;MApBJ;IAsBD;;;WAED,wBAAe0Q,OAAf,EAAwB;MACtB,OAAO,IAAAc,kBAAA,EAAUd,OAAV,CAAP;IACD;;;WAED,4BAAmBe,MAAnB,EAA2B;MACzB,OAAO,CAAC,CAACA,MAAF,IAAY,IAAAC,2BAAA,EAAmBD,MAAnB,CAAnB;IACD;;;WAED,oBAAWE,QAAX,EAAqB;MACnB,OAAO,IAAAC,iBAAA,EAAWD,QAAX,MAAyBxN,iBAAhC;IACD;;;WAED,2BAAkBpD,IAAlB,EAAwB;MACtB,IAAM8Q,WAAW,GAAGhL,eAAe,CAAC9F,IAAD,CAAnC;MACA,OACE,CAAC,CAACA,IAAF,KACC,OAAOA,IAAP,KAAgB,UAAhB,IACC,IAAA+Q,qBAAA,EAAaD,WAAb,CADD,IAEC,IAAAnE,0BAAA,EAAkBmE,WAAlB,CAFD,IAGC,IAAA9D,0BAAA,EAAkB8D,WAAlB,CAHD,IAIC,IAAAnQ,mBAAA,EAAWmQ,WAAX,CALF,CADF;IAQD;;;WAED,2BAAkB9Q,IAAlB,EAAwB;MACtB,OAAO,CAAC,CAACA,IAAF,IAAU,IAAAgN,0BAAA,EAAkBlH,eAAe,CAAC9F,IAAD,CAAjC,CAAjB;IACD;;;WAED,kCAAyByK,IAAzB,EAA+B;MAC7B,IAAI,CAACA,IAAD,IAAS,CAAC,KAAKuG,cAAL,CAAoBvG,IAApB,CAAd,EAAyC;QACvC,OAAO,KAAP;MACD;;MACD,OAAO,KAAKvB,iBAAL,CAAuBuB,IAAI,CAACzK,IAA5B,CAAP;IACD;;;WAED,iCAAwBiR,QAAxB,EAAkC;MAChC;MACA,IAAIA,QAAJ,EAAc;QACZ,IAAIvL,QAAJ;;QACA,IAAIuL,QAAQ,CAACtL,QAAb,EAAuB;UACrB;UACGD,QAFkB,GAELuL,QAAQ,CAACtL,QAFJ,CAElBD,QAFkB;QAGtB,CAHD,MAGO,IAAIuL,QAAQ,CAACvL,QAAb,EAAuB;UACzBA,QADyB,GACZuL,QADY,CACzBvL,QADyB;QAE7B;;QACD,IAAIA,QAAJ,EAAc;UACZ,OAAOA,QAAP;QACD;MACF;;MACD,MAAM,IAAIpB,KAAJ,CAAU,2EAAV,CAAN;IACD;;;WAED,yBAAuB;MAAA,mCAANmC,IAAM;QAANA,IAAM;MAAA;;MACrB,OAAOrB,OAAO,CAAC;QAAA,oBAAMnE,iBAAA,CAAMC,aAAN,OAAAD,iBAAA,EAAuBwF,IAAvB,CAAN;MAAA,CAAD,CAAd;IACD;;;WAED,mCAA0BxH,IAA1B,EAAgC2H,OAAhC,EAAyC;MACvC,OAAO;QACLsK,UAAU,EAAVA,8BADK;QAELjS,IAAI,EAAE,IAAAkS,6CAAA,EAA0BlQ,iBAAA,CAAMC,aAAhC,EAA+CjC,IAA/C,EAAqD2H,OAArD;MAFD,CAAP;IAID;;;;EAhjBgCuI,qB;;AAmjBnCiC,MAAM,CAACC,OAAP,GAAiBhL,oBAAjB"}